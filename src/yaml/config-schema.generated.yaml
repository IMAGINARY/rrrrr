$schema: http://json-schema.org/draft-07/schema#
title: Config
type: object
properties:
  general:
    $ref: '#/definitions/GeneralConfig'
  model:
    type: object
    properties:
      initialParameters:
        $ref: '#/definitions/InitialParametersConfig'
      initialStocks:
        $ref: '#/definitions/InitialStocksConfig'
    required:
      - initialParameters
      - initialStocks
    additionalProperties: false
  simulation:
    type: object
    properties:
      deltaPerSecond:
        type: number
      maxStepSize:
        type: number
    required:
      - deltaPerSecond
      - maxStepSize
    additionalProperties: false
  parameterTransforms:
    type: array
    items:
      $ref: '#/definitions/ParameterTransformConfig'
  interaction:
    $ref: '#/definitions/InteractionConfig'
  layers:
    $ref: '#/definitions/LayersConfig'
required:
  - general
  - model
  - simulation
  - parameterTransforms
  - interaction
  - layers
additionalProperties: false
definitions:
  I18nConfig:
    type: object
    additionalProperties:
      type: string
  GeneralConfig:
    type: object
    properties:
      assetBaseDir:
        type: string
      primaryLanguage:
        type: string
      secondaryLanguage:
        type: string
      description:
        $ref: '#/definitions/I18nConfig'
      scoreLabels:
        type: object
        properties:
          circularity:
            $ref: '#/definitions/I18nConfig'
          coverage:
            $ref: '#/definitions/I18nConfig'
        required:
          - circularity
          - coverage
        additionalProperties: false
      autoReset:
        type: object
        properties:
          timeoutSeconds:
            type: number
            minimum: 0
          condition:
            type: string
          title:
            $ref: '#/definitions/I18nConfig'
          description:
            $ref: '#/definitions/I18nConfig'
        required:
          - timeoutSeconds
          - condition
          - title
          - description
        additionalProperties: false
    required:
      - assetBaseDir
      - primaryLanguage
      - secondaryLanguage
      - description
      - scoreLabels
      - autoReset
    additionalProperties: false
  InitialParametersConfig:
    type: object
    properties:
      abandonExcessRate:
        type: number
      abandonRate:
        type: number
      acquireRate:
        type: number
      breakRate:
        type: number
      capacityAdjustmentRate:
        type: number
      disposeIncentive:
        type: number
      disposeRate:
        type: number
      landfillIncentive:
        type: number
      landfillRate:
        type: number
      naturalResourceMiningRate:
        type: number
      naturalResourcesIncentive:
        type: number
      newPhoneProductionRate:
        type: number
      newlyProducedPhoneIncentive:
        type: number
      numberOfUsers:
        type: number
      phonesPerUserGoal:
        type: number
      recycleRate:
        type: number
      recyclingIncentive:
        type: number
      refurbishmentIncentive:
        type: number
      refurbishmentRate:
        type: number
      repairIncentive:
        type: number
      repairRate:
        type: number
      reuseIncentive:
        type: number
      userdata:
        type: number
    required:
      - abandonExcessRate
      - abandonRate
      - acquireRate
      - breakRate
      - capacityAdjustmentRate
      - disposeIncentive
      - disposeRate
      - landfillIncentive
      - landfillRate
      - naturalResourceMiningRate
      - naturalResourcesIncentive
      - newPhoneProductionRate
      - newlyProducedPhoneIncentive
      - numberOfUsers
      - phonesPerUserGoal
      - recycleRate
      - recyclingIncentive
      - refurbishmentIncentive
      - refurbishmentRate
      - repairIncentive
      - repairRate
      - reuseIncentive
      - userdata
    additionalProperties: false
  InitialStocksConfig:
    type: object
    properties:
      capacityOfNaturalResources:
        type: number
      capacityOfNewlyProducedPhones:
        type: number
      capacityOfPhonesInUse:
        type: number
      capacityOfRecycledMaterials:
        type: number
      capacityOfRefurbishedPhones:
        type: number
      capacityOfRepairedPhones:
        type: number
      phonesInUse:
        type: number
      supplyOfBrokenPhones:
        type: number
      supplyOfDisposedPhones:
        type: number
      supplyOfHibernatingPhones:
        type: number
      supplyOfNaturalResources:
        type: number
      supplyOfNewlyProducedPhones:
        type: number
      supplyOfRecycledMaterials:
        type: number
      supplyOfRefurbishedPhones:
        type: number
      supplyOfRepairedPhones:
        type: number
    required:
      - capacityOfNaturalResources
      - capacityOfNewlyProducedPhones
      - capacityOfPhonesInUse
      - capacityOfRecycledMaterials
      - capacityOfRefurbishedPhones
      - capacityOfRepairedPhones
      - phonesInUse
      - supplyOfBrokenPhones
      - supplyOfDisposedPhones
      - supplyOfHibernatingPhones
      - supplyOfNaturalResources
      - supplyOfNewlyProducedPhones
      - supplyOfRecycledMaterials
      - supplyOfRefurbishedPhones
      - supplyOfRepairedPhones
    additionalProperties: false
  ParameterTransformConfig:
    type: object
    properties:
      id:
        type: string
      script:
        type: string
    required:
      - id
      - script
    additionalProperties: false
  SlotGroupAssetConfig:
    type: object
    properties:
      markerSlotActive:
        type: object
        properties:
          url:
            type: string
            pattern: _x[+-]?[0-9]+_y[+-]?[0-9]+\.[a-zA-Z0-9]+$
        required:
          - url
        additionalProperties: false
      markerSlotInactive:
        type: object
        properties:
          url:
            type: string
            pattern: _x[+-]?[0-9]+_y[+-]?[0-9]+\.[a-zA-Z0-9]+$
        required:
          - url
        additionalProperties: false
    required:
      - markerSlotActive
      - markerSlotInactive
    additionalProperties: false
  MarkerSlotConfig:
    type: object
    properties:
      id:
        type: string
      x:
        type: number
      'y':
        type: number
      angle:
        type: number
    required:
      - id
      - x
      - 'y'
      - angle
    additionalProperties: false
  BasicSlotGroupConfig:
    type: object
    properties:
      id:
        type: string
        pattern: ^((?!internal).)*$
      type:
        type: string
        enum:
          - basic
      label:
        $ref: '#/definitions/I18nConfig'
      assets:
        $ref: '#/definitions/SlotGroupAssetConfig'
      markerSlots:
        type: array
        items:
          $ref: '#/definitions/MarkerSlotConfig'
      parameterTransformIds:
        type: array
        items:
          type: string
    required:
      - id
      - type
      - label
      - assets
      - markerSlots
      - parameterTransformIds
    additionalProperties: false
  CardSlotConfig:
    type: object
    properties:
      id:
        type: string
      x:
        type: number
      'y':
        type: number
      angle:
        type: number
    required:
      - id
      - x
      - 'y'
      - angle
    additionalProperties: false
  CardConfig:
    type: object
    properties:
      parameterTransformId:
        type: string
      url:
        type: string
    required:
      - parameterTransformId
      - url
    additionalProperties: false
  ActionCardSlotGroupConfig:
    type: object
    properties:
      id:
        type: string
        pattern: ^((?!internal).)*$
      type:
        type: string
        enum:
          - action-card
      label:
        $ref: '#/definitions/I18nConfig'
      assets:
        $ref: '#/definitions/SlotGroupAssetConfig'
      slots:
        type: array
        items:
          type: object
          properties:
            markerSlot:
              $ref: '#/definitions/MarkerSlotConfig'
            cardSlot:
              $ref: '#/definitions/CardSlotConfig'
          required:
            - markerSlot
            - cardSlot
          additionalProperties: false
      cards:
        type: array
        items:
          $ref: '#/definitions/CardConfig'
    required:
      - id
      - type
      - label
      - assets
      - slots
      - cards
    additionalProperties: false
  EventCardSlotGroupConfig:
    type: object
    properties:
      id:
        type: string
        pattern: ^((?!internal).)*$
      type:
        type: string
        enum:
          - event-card
      label:
        $ref: '#/definitions/I18nConfig'
      assets:
        $ref: '#/definitions/SlotGroupAssetConfig'
      markerSlot:
        $ref: '#/definitions/MarkerSlotConfig'
      cardSlots:
        type: array
        items:
          $ref: '#/definitions/CardSlotConfig'
      cards:
        type: array
        items:
          $ref: '#/definitions/CardConfig'
    required:
      - id
      - type
      - label
      - assets
      - markerSlot
      - cardSlots
      - cards
    additionalProperties: false
  SlotGroupConfig:
    anyOf:
      - $ref: '#/definitions/BasicSlotGroupConfig'
      - $ref: '#/definitions/ActionCardSlotGroupConfig'
      - $ref: '#/definitions/EventCardSlotGroupConfig'
  InteractionConfig:
    type: object
    properties:
      actionCardDelayMs:
        type: number
        minimum: 0
      eventCardMinDelayMs:
        type: number
        minimum: 0
      eventCardMaxDelayMs:
        type: number
        minimum: 0
      eventCardMinDurationMs:
        type: number
        minimum: 0
      eventCardMaxDurationMs:
        type: number
        minimum: 0
      slotGroups:
        type: array
        items:
          $ref: '#/definitions/SlotGroupConfig'
    required:
      - actionCardDelayMs
      - eventCardMinDelayMs
      - eventCardMaxDelayMs
      - eventCardMinDurationMs
      - eventCardMaxDurationMs
      - slotGroups
    additionalProperties: false
  ModelVisualizationLayerConfig:
    type: string
    enum:
      - modelVisualization
  ConditionalLayerConfig:
    type: object
    properties:
      url:
        type: string
        pattern: _x[+-]?[0-9]+_y[+-]?[0-9]+\.[a-zA-Z0-9]+$
      condition:
        type: string
    required:
      - url
      - condition
    additionalProperties: false
  LayerConfig:
    anyOf:
      - $ref: '#/definitions/ModelVisualizationLayerConfig'
      - $ref: '#/definitions/ConditionalLayerConfig'
  LayersConfig:
    type: array
    items:
      $ref: '#/definitions/LayerConfig'
