!function(){let e;function t(e){Object.defineProperty(e,"__esModule",{value:!0,configurable:!0})}function r(e,t,r,o){Object.defineProperty(e,t,{get:r,set:o,enumerable:!0,configurable:!0})}function o(e){return e&&e.__esModule?e.default:e}var a,n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i={},s={},l=n.parcelRequireacb9;null==l&&((l=function(e){if(e in i)return i[e].exports;if(e in s){var t=s[e];delete s[e];var r={id:e,exports:{}};return i[e]=r,t.call(r.exports,r,r.exports),r.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){s[e]=t},n.parcelRequireacb9=l);var c=l.register;c("fkeW0",function(e,o){t(e.exports),r(e.exports,"default",function(){return M});var a=l("djimy"),n=l("djoOt"),i=l("1Ubyj"),s=l("bA8zD"),c=l("4I7K4"),u=l("gakAE"),d=l("lbosM"),p=l("4TkLj"),f=l("2vvax"),m=l("1VbKL"),h=l("jrojO"),g=l("kIEuR"),y=l("5RKs2"),b=l("eU4UV"),S=l("7Rjir"),_=l("flGFW"),k=l("7dQGn"),x=l("f4LB1"),C=l("i5N9G"),P=l("8C4qt"),T=l("6h466"),E=l("aDsGb"),I=l("9cXwb"),M=/*#__PURE__*/(0,a.defineComponent)({__name:"App",setup(e,{expose:t}){t();let r=(0,_.useOptionStore)(),{config:o}=(0,k.useConfigStore)(),l=(0,x.useAppStore)(),M=(0,C.useModelStore)(),R=new E.CircularEconomyModel,O=new T.ModelSimulator(R,{...o.model.initialStocks},{...o.model.initialParameters},0,o.simulation.deltaPerSecond,o.simulation.maxStepSize),A=new I.Runner;(0,a.watchEffect)(()=>{l.isPlaying?A.play():A.pause()}),(0,a.watchEffect)(()=>{Object.assign(O.parameters,{...M.transformedParameters}),// eslint-disable-next-line no-console
console.log("Update model parameters",O.parameters)}),A.tick(),(0,a.watch)(()=>l.isFullscreen,e=>{(0,P.ignorePromise)(e?document.documentElement.requestFullscreen():document.exitFullscreen())});let w=(0,a.ref)(!1),N=()=>{w.value=!w.value},B=()=>{l.isDeveloperModeActive=!l.isDeveloperModeActive},D=()=>{l.isPlaying=!l.isPlaying},j=()=>{l.isFullscreen=!l.isFullscreen},L=()=>{l.highlightDerivatives=!l.highlightDerivatives},V=M.reset;(0,n.onKeyStroke)(S.HOTKEYS.controlPanel.key,N),(0,n.onKeyStroke)(S.HOTKEYS.developerMode.key,B),(0,n.onKeyStroke)(S.HOTKEYS.run.key,D),(0,n.onKeyStroke)(S.HOTKEYS.fullscreen.key,j),(0,n.onKeyStroke)(S.HOTKEYS.highlightDerivatives.key,L),(0,n.onKeyStroke)(S.HOTKEYS.reset.key,V),(0,a.watchEffect)(()=>{l.isPlaying?A.play():A.pause()});let F=(0,a.ref)([]);(0,a.onMounted)(()=>{A.on("tick",e=>{/**
     * The current record from the model store can be externally modified,
     * e.g. through the reset function. To ensure that the simulator is in sync,
     * some properties are copied over from the model store to the simulator.
     *
     * TODO: Refactor the simulator such that is uses the global state directly
     *       to make syncing unnecessary.
     */let{parameters:t}=O.record;Object.assign(O.record,M.record,{parameters:t});let{t:r}=O.record;O.tick(e);let{t:o}=O.record,a=o-r,{record:n}=O;M.$patch({record:n}),/* eslint-disable */F.value.forEach(t=>t.update(e,a,O.record))})});let G={options:r,config:o,appStore:l,modelStore:M,model:R,modelSimulator:O,runner:A,enableControlPanel:w,toggleControlPanel:N,toggleDeveloperMode:B,togglePlayPause:D,toggleFullscreen:j,toggleHighlightDerivatives:L,resetModel:V,modelVisualizations:F,ScaledLetterBox:i.default,PointerMarkerPanel:s.default,TuioMarkerPanel:c.default,ScoreLayer:u.default,ControlPanel:d.default,ConditionalLayer:p.default,BasicSlotGroup:f.default,ActionCardSlotGroup:m.default,EventCardSlotGroup:h.default,ModelVisualization:g.default,ResetTimeoutOverlay:y.default,get BUILTIN_LAYER_NAMES(){return b.BUILTIN_LAYER_NAMES},get BOARD_WIDTH(){return S.BOARD_WIDTH},get BOARD_HEIGHT(){return S.BOARD_HEIGHT}};return Object.defineProperty(G,"__isScriptSetup",{enumerable:!1,value:!0}),G}})}),c("1Ubyj",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("9WNvp")).__esModule&&(o=o.default),o.render=l("9QxH9").render,o.__cssModules={},l("f4glk").default(o),o.__scopeId="data-v-350340",o.__file="ScaledLetterbox.vue";var a=o}),c("9WNvp",function(e,o){t(e.exports),r(e.exports,"default",function(){return i});var a=l("djimy"),n=l("hWymx"),i=/*#__PURE__*/(0,a.defineComponent)({__name:"ScaledLetterbox",props:{targetSize:{}},emits:["resize"],setup(e,{expose:t,emit:r}){t();let o=(0,a.ref)(null),i=(0,a.ref)(null),s=(0,a.ref)({translateX:0,translateY:0,scale:1});(0,a.onMounted)(()=>{(0,n.strict)(null!==o.value);let t=o.value,i=()=>{let o=t.getBoundingClientRect(),a=Math.min(o.width/e.targetSize.width,o.height/e.targetSize.height);s.value={translateX:o.width/2,translateY:o.height/2,scale:a},r("resize",a)},l=new ResizeObserver(i);l.observe(t),i(),(0,a.onUnmounted)(()=>l.disconnect())});let l={props:e,emit:r,outerElement:o,innerElement:i,transformInfo:s};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}})}),c("9QxH9",function(e,t){r(e.exports,"render",function(){return n});var o=l("djimy");let a={ref:"outerElement",class:"outer"};function n(e,t,r,n,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",a,[(0,o.createElementVNode)("div",{ref:"innerElement",class:"inner",style:(0,o.normalizeStyle)({"--target-width":n.props.targetSize.width,"--target-height":n.props.targetSize.height,"--translate-x":n.transformInfo.translateX,"--translate-y":n.transformInfo.translateY,"--scale":n.transformInfo.scale})},[(0,o.renderSlot)(e.$slots,"default")],4)],512)}}),c("f4glk",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("bA8zD",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("k9l3C")).__esModule&&(o=o.default),o.render=l("dWDNN").render,o.__cssModules={},l("hfCe3").default(o),o.__scopeId="data-v-f20b9f",o.__file="PointerMarkerPanel.vue";var a=o}),c("k9l3C",function(e,o){t(e.exports),r(e.exports,"default",function(){return p});var a=l("djimy"),n=l("hWymx"),i=l("9OMm5"),s=l("7Rjir"),c=l("dLTM2"),u=l("f4LB1"),d=l("02fmQ"),p=/*#__PURE__*/(0,a.defineComponent)({__name:"PointerMarkerPanel",setup(e,{expose:t}){t();let r=(0,u.useAppStore)(),{markerPositions:o,addMarker:a,moveMarker:l}=(0,d.useMarkerStore)(),p=(0,i.useArrayFilter)(o,({id:e})=>e.startsWith("pointer-marker-"));(0,s.POINTER_MARKER_COORDINATES).forEach(({x:e,y:t},r)=>a({id:`pointer-marker-${r}`,x:e,y:t}));let f=new Map,m={appStore:r,markerPositions:o,addMarker:a,moveMarker:l,pointerMarkers:p,offsets:f,onPointerDown:(e,t)=>{let{target:o}=e;(0,n.strict)(o instanceof HTMLElement),o.setPointerCapture(e.pointerId);let a={x:e.clientX/r.scale-t.x,y:e.clientY/r.scale-t.y};f.set(t.id,a)},onPointerMove:(e,t)=>{let{target:o}=e;if((0,n.strict)(o instanceof HTMLElement),!o.hasPointerCapture(e.pointerId))return;let a=f.get(t.id);(0,n.strict)(void 0!==a);// eslint-disable-next-line no-param-reassign
let i=e.clientX/r.scale-a.x,s=e.clientY/r.scale-a.y;l({id:t.id,x:i,y:s})},onPointerUpOrCancel:(e,t)=>{let{target:r}=e;(0,n.strict)(null!==r&&r instanceof HTMLElement),r.releasePointerCapture(e.pointerId)},MarkerUnderlay:c.default};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}})}),c("7Rjir",function(e,t){r(e.exports,"CONFIG_URLS",function(){return a}),r(e.exports,"CONFIG_INJECTION_KEY",function(){return n}),r(e.exports,"BOARD_WIDTH",function(){return i}),r(e.exports,"BOARD_HEIGHT",function(){return s}),r(e.exports,"MARKER_CIRCLE_DIAMETER",function(){return l}),r(e.exports,"NUM_POINTER_MARKERS",function(){return c}),r(e.exports,"POINTER_MARKER_COORDINATES",function(){return u}),r(e.exports,"SLOT_CIRCLE_DIAMETER",function(){return d}),r(e.exports,"HOTKEYS",function(){return p}),r(e.exports,"GIT_VERSION_INFO",function(){return f}),r(e.exports,"TRANSPARENT_PIXEL_DATA_URL",function(){return m});// @ts-expect-error The import attribute is resolved by the Parcel bundler, but not supported in the current TypeScript configuration
let o=new URL("./config/",window.location.href),a=["general.yaml","model.yaml","simulation.yaml","parameter-transforms.yaml","interaction.yaml","layers.yaml"].map(e=>new URL(e,o)),n=Symbol("config injection key"),i=3840,s=2160,l=74.3*i/1209.6,c=8,u=Array(c).fill(0).map(()=>({x:188,y:1589})),d=l,p={run:{key:" ",label:"space"},controlPanel:{key:"c",label:"c"},developerMode:{key:"d",label:"d"},fullscreen:{key:"f",label:"f"},highlightDerivatives:{key:"h",label:"h"},reset:{key:"r",label:"r"}},f={hash:"751f8c3df65f76933275d496ef19b35b84f993ea",tag:"v1.3.1-dist-6-g751f8c3"},m="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg=="}),c("dLTM2",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("kpnqw")).__esModule&&(o=o.default),o.render=l("awOVi").render,o.__cssModules={},l("cdnTT").default(o),o.__scopeId="data-v-9f6c2c",o.__file="MarkerUnderlay.vue";var a=o}),c("kpnqw",function(e,o){t(e.exports),r(e.exports,"default",function(){return s});var a=l("djimy"),n=l("7Rjir"),i=l("f4LB1"),s=/*#__PURE__*/(0,a.defineComponent)({__name:"MarkerUnderlay",props:{markerId:{},x:{},y:{}},setup(e,{expose:t}){t();let r=(0,i.useAppStore)(),o={appStore:r,props:e,get MARKER_CIRCLE_DIAMETER(){return n.MARKER_CIRCLE_DIAMETER}};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}})}),c("f4LB1",function(e,t){r(e.exports,"useAppStore",function(){return i});var o=l("kV0Ly"),a=l("djimy"),n=l("flGFW");let i=(0,o.defineStore)("app",()=>{let e=(0,n.useOptionStore)(),t=(0,a.ref)(e.autoStart),r=(0,a.ref)(!1),o=(0,a.ref)(e.developerMode),i=(0,a.ref)(e.highlightDerivatives),s=(0,a.ref)(e.markerSlotLabels),l=(0,a.ref)(e.autoReset),c=(0,a.ref)(1);return{isPlaying:t,isFullscreen:r,isDeveloperModeActive:o,highlightDerivatives:i,showMarkerSlotLabels:s,autoReset:l,scale:c}})}),c("flGFW",function(e,t){r(e.exports,"sentryDsn",function(){return y}),r(e.exports,"useOptionStore",function(){return b});var o=l("kV0Ly"),a=l("7Rjir");let n=new URLSearchParams(window.location.search),i=(n.get("tuio")??"true")==="true",s=(n.get("pointer")??"false")==="true",c=Number.parseInt(n.get("numPointerMarkers")??`${a.NUM_POINTER_MARKERS}`,10),u=n.get("tuioUrl")??"ws://localhost:3339",d=1e3*Number.parseInt(n.get("tuioReconnectionDelay")??"10",10),p=(n.get("autoStart")??"true")==="true",f=(n.get("devMode")??"false")==="true",m=(n.get("highlightDerivatives")??"true")==="true",h=(n.get("markerSlotLabels")??"true")==="true",g=(n.get("autoReset")??"true")==="true",y=n.get("sentryDsn"),b=(0,o.defineStore)("options",()=>({useTuioMarkers:i,usePointerMarkers:s,numPointerMarkers:c,tuioUrl:u,tuioReconnectionDelayMs:d,autoStart:p,developerMode:f,highlightDerivatives:m,markerSlotLabels:h,autoReset:g,sentryDsn:y}))}),c("awOVi",function(e,t){r(e.exports,"render",function(){return s});var o,a=l("djimy");let n=(o=()=>/*#__PURE__*/(0,a.createElementVNode)("div",{class:"circle"},null,-1),(0,a.pushScopeId)("data-v-9f6c2c"),o=o(),(0,a.popScopeId)(),o),i={key:0};function s(e,t,r,o,s,l){return(0,a.openBlock)(),(0,a.createElementBlock)("div",{class:"marker",style:(0,a.normalizeStyle)({"--marker-position-x":o.props.x,"--marker-position-y":o.props.y,"--marker-diameter":o.MARKER_CIRCLE_DIAMETER})},[n,o.appStore.isDeveloperModeActive?((0,a.openBlock)(),(0,a.createElementBlock)("span",i,(0,a.toDisplayString)(o.props.markerId),1)):(0,a.createCommentVNode)("",!0)],4)}}),c("cdnTT",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("02fmQ",function(e,t){r(e.exports,"useMarkerStore",function(){return d});var o=l("kV0Ly"),a=l("djimy"),n=l("7Rjir"),i=l("flGFW"),s=l("46h5Q");l("h1KQv");var c=l("4Bz8r"),u=l("le1Q3");let d=(0,o.defineStore)("marker",()=>{let e=(0,i.useOptionStore)(),t=(0,a.ref)([]),r=e=>{let r=-1;do -1!==(r=t.value.findIndex(({id:t})=>t===e.id))&&t.value.splice(r,1);while(-1!==r)},o=e=>{r(e),t.value.push({...e})},l=e=>{let r=t.value.find(({id:t})=>t===e.id);if(void 0===r){o(e);return}r.x=e.x,r.y=e.y},d=new s.Tuio11EventEmitter;if(e.useTuioMarkers){let t=new c.Tuio11Client(new u.WebsocketTuioReceiverExt(e.tuioUrl,e.tuioReconnectionDelayMs));t.addTuioListener(d),/*
     * FIXME:
     *   This is a workaround to not miss the initial marker events that are emitted directly after the connection is
     *   established.
     */setTimeout(()=>t.connect(),0)}return d.on("tuio-object-add",e=>{o({id:`tuio-${e.sessionId}`,x:e.xPos*n.BOARD_WIDTH,y:e.yPos*n.BOARD_HEIGHT})}),d.on("tuio-object-update",e=>{l({id:`tuio-${e.sessionId}`,x:e.xPos*n.BOARD_WIDTH,y:e.yPos*n.BOARD_HEIGHT})}),d.on("tuio-object-remove",e=>{r({id:`tuio-${e.sessionId}`,x:e.xPos*n.BOARD_WIDTH,y:e.yPos*n.BOARD_HEIGHT})}),{markerPositions:(0,a.readonly)(t),removeMarker:r,addMarker:o,moveMarker:l}})}),c("46h5Q",function(e,t){r(e.exports,"Tuio11EventEmitter",function(){return a});var o=l("3ZGF0");class a extends o.EventEmitter{addTuioObject(e){this.emit("tuio-object-add",e)}updateTuioObject(e){this.emit("tuio-object-update",e)}removeTuioObject(e){this.emit("tuio-object-remove",e)}addTuioCursor(e){this.emit("tuio-cursor-add",e)}updateTuioCursor(e){this.emit("tuio-cursor-update",e)}removeTuioCursor(e){this.emit("tuio-cursor-remove",e)}addTuioBlob(e){this.emit("tuio-blob-add",e)}updateTuioBlob(e){this.emit("tuio-blob-update",e)}removeTuioBlob(e){this.emit("tuio-blob-remove",e)}refresh(e){this.emit("refresh",e)}}}),c("h1KQv",function(e,t){r(e.exports,"Tuio11Client",function(){return l("4Bz8r").Tuio11Client}),l("7oQXN"),l("4Bz8r")}),c("7oQXN",function(e,t){r(e.exports,"TuioReceiver",function(){return l("bNthR").TuioReceiver}),r(e.exports,"Tuio11Client",function(){return l("4Bz8r").Tuio11Client}),l("aepZW"),l("bNthR"),l("2SMZK"),l("bSOPx"),l("4IIOm"),l("2Cyxe"),l("4Bz8r"),l("cmRMF"),l("02co9"),l("b3X4E"),l("1lgn3");/* Exclude TUIO 2.0 code for now
// TUIO 2.0 code
import { Tuio20Bounds } from './tuio20/Tuio20Bounds.js';
import { Tuio20Client } from './tuio20/Tuio20Client.js';
import { Tuio20Component } from './tuio20/Tuio20Component.js';
import { Tuio20Object } from './tuio20/Tuio20Object.js';
import { Tuio20Point } from './tuio20/Tuio20Point.js';
import { Tuio20Pointer } from './tuio20/Tuio20Pointer.js';
import { Tuio20Symbol } from './tuio20/Tuio20Symbol.js';
import { Tuio20Token } from './tuio20/Tuio20Token.js';

export {
  Tuio20Bounds,
  Tuio20Client,
  Tuio20Component,
  Tuio20Object,
  Tuio20Point,
  Tuio20Pointer,
  Tuio20Symbol,
  Tuio20Token,
};
*/}),c("aepZW",function(e,t){class r{static UDP=new r("UDP");static Websocket=new r("Websocket");constructor(e){this.name=e}toString(){return`TuioConnectionType.${this.name}`}}}),c("bNthR",function(e,t){r(e.exports,"TuioReceiver",function(){return o});class o{constructor(){this._isConnected=!1,this._messageListeners={}}connect(){}disconnect(){}onOscMessage(e){let t=this._messageListeners[e.address];if(void 0!==t)for(let r of t)r(e)}addMessageListener(e,t){e in this._messageListeners||(this._messageListeners[e]=[]),this._messageListeners[e].push(t)}}}),c("2SMZK",function(e,t){r(e.exports,"TuioState",function(){return o});class o{static Added=new o("Added");static Accelerating=new o("Accelerating");static Decelerating=new o("Decelerating");static Stopped=new o("Stopped");static Removed=new o("Removed");static Rotating=new o("Rotating");static Idle=new o("Idle");constructor(e){this.name=e}toString(){return`TuioState.${this.name}`}}}),c("bSOPx",function(e,t){r(e.exports,"TuioTime",function(){return o});class o{static _startTime=new o(0,0);constructor(e,t){this._seconds=e,this._microSeconds=t}static fromOscTime(e){return new o(e.raw[0],e.raw[1]/4294967296)}subtract(e){let t=this._seconds-e._seconds,r=this._microSeconds-e._microSeconds;return r<0&&(r+=1e6,t-=1),new o(t,r)}getTotalMilliseconds(){return 1e3*this._seconds+this._microSeconds/1e3}static init(){o._startTime=o._getSystemTime()}static _getSystemTime(){let e=performance.now();return new o(Math.floor(e/1e3),Math.floor(1e3*e)%1e6)}static getCurrentTime(){return o._getSystemTime().subtract(o._startTime)}}}),c("4IIOm",function(e,t){l("9iGn8"),l("bNthR")}),c("2Cyxe",function(e,t){r(e.exports,"Tuio11Blob",function(){return n});var o=l("cmRMF"),a=l("2SMZK");class n extends o.Tuio11Container{constructor(e,t,r,o,a,n,i,s,l,c,u,d,p,f){super(e,t,o,a,c,u,p),this._blobId=t,this._angle=n,this._width=i,this._height=s,this._area=l,this._rotationSpeed=d,this._rotationAccel=f}get blobId(){return this._blobId}get angle(){return this._angle}get width(){return this._angle}get height(){return this._angle}get area(){return this._angle}get rotationSpeed(){return this._rotationSpeed}get rotationAccel(){return this._rotationAccel}_hasChanged(e,t,r,o,a,n,i,s,l,c,u,d){return!(t===this.xPos&&r===this.yPos&&o===this.angle&&a===this.width&&n===this.height&&i===this.area&&s===this.xSpeed&&l===this.ySpeed&&c===this.rotationSpeed&&u===this.motionAccel&&d===this.rotationAccel)}_update(e,t,r,o,n,i,s,l,c,u,d,p){let f=this.path[this.path.length-1],m=t!==this.xPos&&0===l||r!==this.yPos&&0===c;if(this._updateContainer(e,t,r,l,c,d,m),o!==this.angle&&0===u){let t=e.subtract(f.startTime).getTotalMilliseconds()/1e3,r=this.angle,a=this.rotationSpeed,n=(o-r)/(2*Math.PI);n>.5?n-=1:n<=-.5&&(n+=1),this._rotationSpeed=n/t,this._rotationAccel=(this.rotationSpeed-a)/t}else this._rotationSpeed=u,this._rotationAccel=p;this._angle=o,this._state!==a.TuioState.Stopped&&0!==this.rotationAccel&&(this._state=a.TuioState.Rotating),this._width=n,this._height=i,this._area=s}}}),c("cmRMF",function(e,t){r(e.exports,"Tuio11Container",function(){return n});var o=l("1lgn3"),a=l("2SMZK");class n extends o.Tuio11Point{MAX_PATH_LENGTH=128;constructor(e,t,r,n,i,s,l){super(e,r,n),this._currentTime=e,this._sessionId=t,this._xSpeed=i,this._ySpeed=s,this._motionSpeed=Math.sqrt(i*i+s*s),this._motionAccel=l,this._state=a.TuioState.Added,this._prevPoints=[],this._prevPoints.push(new o.Tuio11Point(e,r,n))}get currentTime(){return this._currentTime}get sessionId(){return this._sessionId}get xSpeed(){return this._xSpeed}get ySpeed(){return this._ySpeed}get motionSpeed(){return this._motionSpeed}get motionAccel(){return this._motionAccel}get state(){return this._state}get path(){return this._prevPoints}_updateContainer(e,t,r,n,i,s,l){let c=this.path[this.path.length-1];if(this._xPos=t,this._yPos=r,l){let t=e.subtract(c.startTime).getTotalMilliseconds()/1e3,r=this.xPos-c.xPos,o=this.yPos-c.yPos,a=this.motionSpeed;this._xSpeed=r/t,this._ySpeed=o/t,this._motionSpeed=Math.sqrt(r*r+o*o)/t,this._motionAccel=(this.motionSpeed-a)/t}else this._xSpeed=n,this._ySpeed=i,this._motionSpeed=Math.sqrt(n*n+i*i),this._motionAccel=s;this._currentTime=e,this._prevPoints.push(new o.Tuio11Point(e,t,r)),this._prevPoints.length>this.MAX_PATH_LENGTH&&this._prevPoints.shift(),this._motionAccel>0?this._state=a.TuioState.Accelerating:this._motionAccel<0?this._state=a.TuioState.Decelerating:this._state=a.TuioState.Stopped}_remove(e){this._currentTime=e,this._state=a.TuioState.Removed}}}),c("1lgn3",function(e,t){r(e.exports,"Tuio11Point",function(){return o});class o{constructor(e,t,r){this._startTime=e,this._xPos=t,this._yPos=r}get startTime(){return this._startTime}get xPos(){return this._xPos}get yPos(){return this._yPos}}}),c("4Bz8r",function(e,t){r(e.exports,"Tuio11Client",function(){return s});var o=l("b3X4E"),a=l("02co9"),n=l("2Cyxe"),i=l("bSOPx");class s{constructor(e){this._tuioReceiver=e,this._tuioReceiver.addMessageListener("/tuio/2Dobj",this._on2Dobj.bind(this)),this._tuioReceiver.addMessageListener("/tuio/2Dcur",this._on2Dcur.bind(this)),this._tuioReceiver.addMessageListener("/tuio/2Dblb",this._on2Dblb.bind(this)),this._tuioListeners=[],this._tuioObjects=new Map,this._tuioCursors=new Map,this._tuioBlobs=new Map,this._objectSetMessages=[],this._cursorSetMessages=[],this._blobSetMessages=[],this._objectAliveMessage=null,this._cursorAliveMessage=null,this._blobAliveMessage=null,this._freeCursorIds=[],this._freeBlobIds=[],this._currentFrame=0,this._currentTime=null}connect(){(0,i.TuioTime).init(),this._currentTime=(0,i.TuioTime).getCurrentTime(),this._tuioReceiver.connect()}disconnect(){this._tuioReceiver.disconnect()}addTuioListener(e){this._tuioListeners.push(e)}removeTuioListener(e){let t=this._tuioListeners.indexOf(e);t>-1&&this._tuioListeners.splice(t,1)}removeAllTuioListeners(){this._tuioListeners=[]}getTuioObjects(){return this._tuioObjects.values()}getTuioCursors(){return this._tuioCursors.values()}getTuioBlobs(){return this._tuioBlobs.values()}getTuioObject(e){let t=this._tuioObjects.get(e);return void 0===t?null:t}getTuioCursor(e){let t=this._tuioCursors.get(e);return void 0===t?null:t}getTuioBlob(e){let t=this._tuioBlobs.get(e);return void 0===t?null:t}_updateFrame(e){let t=(0,i.TuioTime).getCurrentTime();if(e>0){if(e>this._currentFrame&&(this._currentTime=t),!(e>=this._currentFrame)&&!(this._currentFrame-e>100))return!1;this._currentFrame=e}else t.subtract(this._currentTime).getTotalMilliseconds()>100&&(this._currentTime=t);return!0}_on2Dobj(e){let t=e.args[0].value;if("set"===t)this._objectSetMessages.push(e);else if("alive"===t)this._objectAliveMessage=e;else if("fseq"===t){let t=e.args[1].value;if(this._updateFrame(t)){if(null!==this._objectAliveMessage){let e=new Set(this._tuioObjects.keys()),t=new Set(this._objectAliveMessage.args.slice(1).map(e=>e.value));for(let r of new Set([...e].filter(e=>!t.has(e)))){let e=this._tuioObjects.get(r);for(let t of(e._remove(this._currentTime),this._tuioListeners))t.removeTuioObject(e);this._tuioObjects.delete(r)}for(let r of this._objectSetMessages){let[,a,n,i,s,l,c,u,d,p,f]=r.args.map(e=>e.value);if(t.has(a)){if(e.has(a)){let e=this._tuioObjects.get(a);if(e._hasChanged(this._currentTime,i,s,l,c,u,d,p,f))for(let t of(e._update(this._currentTime,i,s,l,c,u,d,p,f),this._tuioListeners))t.updateTuioObject(e)}else{let e=new o.Tuio11Object(this._currentTime,a,n,i,s,l,c,u,d,p,f);for(let t of(this._tuioObjects.set(a,e),this._tuioListeners))t.addTuioObject(e)}}}for(let e of this._tuioListeners)e.refresh(this._currentTime)}this._objectSetMessages=[],this._objectAliveMessage=null}}}_on2Dcur(e){let t=e.args[0].value;if("set"===t)this._cursorSetMessages.push(e);else if("alive"===t)this._cursorAliveMessage=e;else if("fseq"===t){let t=e.args[1].value;if(this._updateFrame(t)){if(null!==this._cursorAliveMessage){let e=new Set(this._tuioCursors.keys()),t=new Set(this._cursorAliveMessage.args.slice(1).map(e=>e.value));for(let r of new Set([...e].filter(e=>!t.has(e)))){let e=this._tuioCursors.get(r);for(let t of(e._remove(this._currentTime),this._tuioListeners))t.removeTuioCursor(e);this._tuioCursors.delete(r),this._freeCursorIds.push(e.cursorId)}for(let r of(this._freeCursorIds.sort(),this._cursorSetMessages)){let[,o,n,i,s,l,c]=r.args.map(e=>e.value);if(t.has(o)){if(e.has(o)){let e=this._tuioCursors.get(o);if(e._hasChanged(this._currentTime,n,i,s,l,c))for(let t of(e._update(this._currentTime,n,i,s,l,c),this._tuioListeners))t.updateTuioCursor(e)}else{let e=this._tuioCursors.size;this._freeCursorIds.length>0&&(e=this._freeCursorIds[0],this._freeCursorIds.splice(0,1));let t=new a.Tuio11Cursor(this._currentTime,o,e,n,i,s,l,c);for(let e of(this._tuioCursors.set(o,t),this._tuioListeners))e.addTuioCursor(t)}}}for(let e of this._tuioListeners)e.refresh(this._currentTime)}this._cursorSetMessages=[],this._cursorAliveMessage=null}}}_on2Dblb(e){let t=e.args[0].value;if("set"===t)this._blobSetMessages.push(e);else if("alive"===t)this._blobAliveMessage=e;else if("fseq"===t){let t=e.args[1].value;if(this._updateFrame(t)){if(null!==this._blobAliveMessage){let e=new Set(this._tuioBlobs.keys()),t=new Set(this._blobAliveMessage.args.slice(1).map(e=>e.value));for(let r of new Set([...e].filter(e=>!t.has(e)))){let e=this._tuioBlobs.get(r);for(let t of(e._remove(this._currentTime),this._tuioListeners))t.removeTuioBlob(e);this._tuioBlobs.delete(r),this._freeBlobIds.push(e.blobId)}for(let r of(this._freeBlobIds.sort(),this._blobSetMessages)){let[,o,a,i,s,l,c,u,d,p,f,m,h]=r.args.map(e=>e.value);if(t.has(o)){if(e.has(o)){let e=this._tuioBlobs.get(o);if(e._hasChanged(this._currentTime,a,i,s,l,c,u,d,p,f,m,h))for(let t of(e._update(this._currentTime,a,i,s,l,c,u,d,p,f,m,h),this._tuioListeners))t.updateTuioBlob(e)}else{let e=this._tuioBlobs.size;this._freeBlobIds.length>0&&(e=this._freeBlobIds[0],this._freeBlobIds.splice(0,1));let t=new n.Tuio11Blob(this._currentTime,o,e,a,i,s,l,c,u,d,p,f,m,h);for(let e of(this._tuioBlobs.set(o,t),this._tuioListeners))e.addTuioBlob(t)}}}for(let e of this._tuioListeners)e.refresh(this._currentTime)}this._blobSetMessages=[],this._blobAliveMessage=null}}}}}),c("b3X4E",function(e,t){r(e.exports,"Tuio11Object",function(){return n});var o=l("cmRMF"),a=l("2SMZK");class n extends o.Tuio11Container{constructor(e,t,r,o,a,n,i,s,l,c,u){super(e,t,o,a,i,s,c),this._symbolId=r,this._angle=n,this._rotationSpeed=l,this._rotationAccel=u}get symbolId(){return this._symbolId}get angle(){return this._angle}get rotationSpeed(){return this._rotationSpeed}get rotationAccel(){return this._rotationAccel}_hasChanged(e,t,r,o,a,n,i,s,l){return!(t===this.xPos&&r===this.yPos&&o===this.angle&&a===this.xSpeed&&n===this.ySpeed&&i===this.rotationSpeed&&s===this.motionAccel&&l===this.rotationAccel)}_update(e,t,r,o,n,i,s,l,c){let u=this.path[this.path.length-1],d=t!==this.xPos&&0===n||r!==this.yPos&&0===i;if(this._updateContainer(e,t,r,n,i,l,d),o!==this.angle&&0===s){let t=e.subtract(u.startTime).getTotalMilliseconds()/1e3,r=this.angle,a=this.rotationSpeed,n=(o-r)/(2*Math.PI);n>.5?n-=1:n<=-.5&&(n+=1),this._rotationSpeed=n/t,this._rotationAccel=(this.rotationSpeed-a)/t}else this._rotationSpeed=s,this._rotationAccel=c;this._angle=o,this._state!==a.TuioState.Stopped&&0!==this.rotationAccel&&(this._state=a.TuioState.Rotating)}}}),c("02co9",function(e,t){r(e.exports,"Tuio11Cursor",function(){return a});var o=l("cmRMF");class a extends o.Tuio11Container{constructor(e,t,r,o,a,n,i,s){super(e,t,o,a,n,i,s),this._cursorId=r}get cursorId(){return this._cursorId}_hasChanged(e,t,r,o,a,n){return!(t===this.xPos&&r===this.yPos&&o===this.xSpeed&&a===this.ySpeed&&n===this.motionAccel)}_update(e,t,r,o,a,n){let i=t!==this.xPos&&0===o||r!==this.yPos&&0===a;this._updateContainer(e,t,r,o,a,n,i)}}}),c("le1Q3",function(e,t){r(e.exports,"WebsocketTuioReceiverExt",function(){return n});var o=l("9iGn8");l("7oQXN");var a=l("bNthR");class n extends a.TuioReceiver{constructor(e,t){super(),this._isConnected=!1,this._url=e,this._reconnectIntervalMs=t,this._oscPort=new o.WebSocketPort({url:e,metadata:!0}),this._reconnectTimeout=0,this._handleOscMessage=this.onOscMessage.bind(this),this._handleOscReady=this.onOscReady.bind(this),this._handleOscClose=this.onOscClose.bind(this),this._handleOscError=this.onOscError.bind(this)}scheduleReconnect(){this.disconnect(),console.warn(`Attempting reconnection in ${this._reconnectIntervalMs}ms`),clearTimeout(this._reconnectTimeout),this._reconnectTimeout=setTimeout(()=>this.connect(),this._reconnectIntervalMs)}onOscReady(){this._isConnected=!0,this._oscPort.on("message",this._handleOscMessage),console.log(`TUIO connection to ${this._url} established`)}onOscClose(e){console.warn(`TUIO connection to ${this._url} closed`,e),this.scheduleReconnect()}onOscError(e){console.error("TUIO error: ",e),console.warn(`Terminating TUIO connection ${this._url}`),this.scheduleReconnect()}connect(){console.log(`Connecting to TUIO server ${this._url}`),this._oscPort.once("ready",this._handleOscReady),this._oscPort.once("close",this._handleOscClose),this._oscPort.once("error",this._handleOscError),this._oscPort.once("wsClient",this._handleOscError),this._oscPort.open()}disconnect(){this._oscPort.off("ready",this._handleOscReady),this._oscPort.off("message",this._handleOscMessage),this._oscPort.off("close",this._handleOscClose),this._oscPort.off("error",this._handleOscError),this._oscPort.off("wsClient",this._handleOscError),this._oscPort.close(),this._isConnected=!1}}}),c("dWDNN",function(e,t){r(e.exports,"render",function(){return n});var o=l("djimy");let a={class:"abs-top-left"};function n(e,t,r,n,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",a,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.pointerMarkers,e=>((0,o.openBlock)(),(0,o.createBlock)(n.MarkerUnderlay,{key:e.id,"marker-id":e.id,x:e.x,y:e.y,class:"marker-underlay",onPointerdown:t=>n.onPointerDown(t,e),onPointermove:t=>n.onPointerMove(t,e),onPointerup:t=>n.onPointerUpOrCancel(t,e),onPointercancel:t=>n.onPointerUpOrCancel(t,e)},null,8,["marker-id","x","y","onPointerdown","onPointermove","onPointerup","onPointercancel"]))),128))])}}),c("hfCe3",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("4I7K4",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("RDxjP")).__esModule&&(o=o.default),o.render=l("4bJi3").render,l("4OgPE").default(o),o.__scopeId="data-v-18be12",o.__file="TuioMarkerPanel.vue";var a=o}),c("RDxjP",function(e,o){t(e.exports),r(e.exports,"default",function(){return c});var a=l("djimy"),n=l("9OMm5"),i=l("dLTM2"),s=l("02fmQ"),c=/*#__PURE__*/(0,a.defineComponent)({__name:"TuioMarkerPanel",setup(e,{expose:t}){t();let{markerPositions:r}=(0,s.useMarkerStore)(),o=(0,n.useArrayFilter)(r,({id:e})=>e.startsWith("tuio-")),a={markerPositions:r,tuioMarkers:o,MarkerUnderlay:i.default};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}})}),c("4bJi3",function(e,t){r(e.exports,"render",function(){return n});var o=l("djimy");let a={ref:"container",class:"abs-top-left"};function n(e,t,r,n,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",a,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.tuioMarkers,e=>((0,o.openBlock)(),(0,o.createBlock)(n.MarkerUnderlay,{key:e.id,"marker-id":e.id,x:e.x,y:e.y},null,8,["marker-id","x","y"]))),128))],512)}}),c("4OgPE",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("gakAE",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("jbpl8")).__esModule&&(o=o.default),o.render=l("dGm9e").render,o.__cssModules={},l("2uhUo").default(o),o.__scopeId="data-v-af9577",o.__file="ScoreLayer.vue";var a=o}),c("jbpl8",function(e,o){t(e.exports),r(e.exports,"default",function(){return c});var a=l("djimy"),n=l("7dQGn"),i=l("i5N9G"),s=l("dNJei"),c=/*#__PURE__*/(0,a.defineComponent)({__name:"ScoreLayer",setup(e,{expose:t}){t();let{config:{general:r},getPrimary:o,getSecondary:l}=(0,n.useConfigStore)(),{scoreLabels:c}=r,u=(0,i.useModelStore)(),d={circularity:{cssClasses:["score","score-bottom-right"],boundaries:{min:{value:0,string:"<0%"},max:{value:1,string:">100%"}}},coverage:{cssClasses:["score","score-top-left"],boundaries:{min:{value:0,string:"< 0%"},max:{value:9.99999999999999,string:"> 999%"}}}};function p(e){return{id:e,score:(0,a.computed)(()=>(0,s.Scores)[e](u.record)),primaryLabel:o(c[e]),secondaryLabel:l(c[e]),cssClasses:d[e].cssClasses,boundaries:d[e].boundaries}}let f=Object.keys(d).map(p),m=`\u{2013}.${"".padEnd(1,"–")}`,h={general:r,getPrimary:o,getSecondary:l,scoreLabels:c,modelStore:u,scoreExtraProps:d,createScoreInfo:p,scores:f,fractionDigits:1,nanScoreText:m,format:(e,t)=>Number.isFinite(e)?e<t.min.value?t.min.string:e>t.max.value?t.max.string:`${(100*e).toFixed(1)}%`:e===Number.POSITIVE_INFINITY?`\u{221E}%`:e===Number.NEGATIVE_INFINITY?`\u{2212}\u{221E}%`:`${m}%`};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}})}),c("7dQGn",function(e,t){r(e.exports,"useConfigStore",function(){return m});var o=l("hWymx"),a=l("kV0Ly"),n=l("djimy"),i=l("7Rjir"),s=l("6clsW");let c=e=>{let t=[],r=Object.values(e.assets).map(({url:e})=>e);t.push(...r);let{type:o}=e;switch(o){case"basic":break;case"action-card":case"event-card":{let r=e.cards.map(({url:e})=>e);t.push(...r);break}default:return(0,s.exhaustiveGuard)(o)}return t},u=e=>"string"==typeof e?[]:[e.url],d=e=>{let t=e.interaction.slotGroups.flatMap(c),r=e.layers.flatMap(u);return[...t,...r]},p=async e=>new Promise((t,r)=>{let o=new Image;o.onerror=()=>{console.error(`Failed to load asset: ${e.href}`),r()},o.onload=()=>{t(o)},o.src=e.href}),f=e=>{Promise.all(e.map(p)).catch(()=>console.error("Some assets could not be loaded. See console for details."))},m=(0,a.defineStore)("config",()=>{let e=(0,n.inject)(i.CONFIG_INJECTION_KEY,null);(0,o.strict)(e);let{general:{assetBaseDir:t}}=e,r=new URL(`${t}/`,window.location.href),a=e=>new URL(e,r),s=d(e).map(a);f(s);let l=/_x([+-]?[0-9]+)_y([+-]?[0-9]+)\.[a-zA-Z0-9]+$/,c=e=>{if("string"!=typeof e)return c(e.href);let t=e.match(l);if(null===t||3!==t.length)return{x:0,y:0};let r=Number.parseInt(t[1],10),o=Number.parseInt(t[2],10);return{x:r,y:o}},u=(e,t)=>"string"==typeof e[t]?e[t]:"<undefined>";return{config:e,assetBaseUrl:r,toAssetUrl:a,assetUrls:s,extractAssetPosition:c,getPrimary:t=>(0,n.computed)(()=>u(t,e.general.primaryLanguage)),getSecondary:t=>(0,n.computed)(()=>u(t,e.general.secondaryLanguage))}})}),c("6clsW",function(e,t){r(e.exports,"exhaustiveGuard",function(){return o});function o(e){throw Error(`Reached forbidden guard function with unexpected value: ${JSON.stringify(e)}`)}}),c("i5N9G",function(e,t){r(e.exports,"useModelStore",function(){return f});var o=l("hWymx"),a=l("kV0Ly"),n=l("djimy"),i=l("9OMm5"),s=l("aDsGb"),c=l("7dQGn"),u=l("5rTuK"),d=l("cIjax");let p=e=>{let t=(0,d.useSlotGroupsStore)(),r=(0,u.useParameterTransformsStore)(),{slotGroups:a}=t,{parameterTransforms:n}=r,s=(0,i.reactiveComputed)(()=>{let t={...e.value},r=a.map(({id:e,parameterTransforms:r})=>{let a=r.map(({id:e,active:r})=>{let a=n.find(t=>t.id===e);(0,o.strict)(a,`No transform found for id ${e}`);let{script:i,transform:s}=a,l=r?s({...t}):{...t},c=Object.fromEntries(Object.entries(l).filter(([e,r])=>r!==t[e])),u={id:e,script:i,active:r,before:t,after:l,diff:c};return t={...l},u});return{id:e,steps:a}});return r}),l=(0,i.reactiveComputed)(()=>{let t=(e,t)=>e.length>0?e[e.length-1]:t,r=t(s.map(({steps:r})=>t(r.map(({after:e})=>e),e.value)),e.value);return r});return{transformedParametersExt:s,transformedParameters:l}},f=(0,a.defineStore)("model",()=>{let{config:{model:e}}=(0,c.useConfigStore)(),t=new(0,s.CircularEconomyModel)().evaluate((0,n.toRaw)(e.initialStocks),(0,n.toRaw)(e.initialParameters),0);console.log(t);let r=(0,n.ref)(structuredClone(t)),o=(0,n.ref)({...e.initialParameters}),{transformedParameters:a,transformedParametersExt:i}=p(o);return{record:r,initialParameters:o,transformedParameters:a,transformedParametersExt:i,reset:()=>{r.value=structuredClone(t)}}})}),c("aDsGb",function(e,t){r(e.exports,"stockIds",function(){return a}),r(e.exports,"flowIds",function(){return n}),r(e.exports,"variableIds",function(){return i}),r(e.exports,"parameterIds",function(){return s}),r(e.exports,"CircularEconomyModel",function(){return c});// This file was auto-generated from the InsightMaker model. Do not edit it manually.
var o=l("jRMUH");let a=["capacityOfNaturalResources","capacityOfNewlyProducedPhones","capacityOfPhonesInUse","capacityOfRecycledMaterials","capacityOfRefurbishedPhones","capacityOfRepairedPhones","phonesInUse","supplyOfBrokenPhones","supplyOfDisposedPhones","supplyOfHibernatingPhones","supplyOfNaturalResources","supplyOfNewlyProducedPhones","supplyOfRecycledMaterials","supplyOfRefurbishedPhones","supplyOfRepairedPhones"],n=["abandon","acquireNewlyProduced","acquireRefurbished","acquireRepaired","acquireUsed","capacityOfNaturalResourcesAdjustment","capacityOfNewlyProducedPhonesAdjustment","capacityOfPhonesInUseAdjustment","capacityOfRecycledMaterialsAdjustment","capacityOfRefurbishedPhonesAdjustment","disposeBroken","disposeHibernating","goBroken","landfill","mineNaturalResources","produceFromNaturalResources","produceFromRecycledMaterials","recycle","refurbish","repair","repairShopCapcityAdjustment"],i=["circularityScore","coverageScore","demandForMining","demandForNaturalResources","demandForNewlyProducedPhones","demandForPhones","demandForRecycledMaterials","demandForRecycling","demandForRefurbishedPhones","demandForRefurbishment","demandForRepair","demandForRepairedPhones","demandForResources","demandForReusedPhones","inflowIncentiveSumForPhonesInUse","phoneGoal","phonesInUseExcess","supplyOfBrokenPhonesForDisposal","supplyOfBrokenPhonesForRepair","supplyOfDisposedPhonesForLandfilling","supplyOfDisposedPhonesForRecycling","supplyOfHibernatingPhonesForDisposal","supplyOfHibernatingPhonesForRefurbishment","supplyOfHibernatingPhonesForReuse","weightedSumOfBadFlows","weightedSumOfGoodFlows"],s=["abandonExcessRate","abandonRate","acquireRate","breakRate","capacityAdjustmentRate","disposeIncentive","disposeRate","landfillIncentive","landfillRate","naturalResourceMiningRate","naturalResourcesIncentive","newPhoneProductionRate","newlyProducedPhoneIncentive","numberOfUsers","phonesPerUserGoal","recycleRate","recyclingIncentive","refurbishmentIncentive","refurbishmentRate","repairIncentive","repairRate","reuseIncentive","userdata"];class c extends o.Model{static #e=this.initialStocks={capacityOfNaturalResources:0,capacityOfNewlyProducedPhones:0,capacityOfPhonesInUse:0,capacityOfRecycledMaterials:0,capacityOfRefurbishedPhones:0,capacityOfRepairedPhones:0,phonesInUse:0,supplyOfBrokenPhones:0,supplyOfDisposedPhones:0,supplyOfHibernatingPhones:0,supplyOfNaturalResources:0,supplyOfNewlyProducedPhones:0,supplyOfRecycledMaterials:0,supplyOfRefurbishedPhones:0,supplyOfRepairedPhones:0};static #t=this.defaultParameters={abandonExcessRate:.5,abandonRate:.1,acquireRate:1,breakRate:.1,capacityAdjustmentRate:.1,disposeIncentive:.5,disposeRate:.5,landfillIncentive:.5,landfillRate:1,naturalResourceMiningRate:.5,naturalResourcesIncentive:.5,newPhoneProductionRate:.5,newlyProducedPhoneIncentive:.82,numberOfUsers:1e6,phonesPerUserGoal:1,recycleRate:1,recyclingIncentive:.89,refurbishmentIncentive:.5,refurbishmentRate:1,repairIncentive:.5,repairRate:1,reuseIncentive:.86,userdata:0};constructor(){super(a,n,i,s)}// eslint-disable-next-line class-methods-use-this
evaluate(e,t,r){/* eslint-disable @typescript-eslint/no-unused-vars */let{capacityOfNaturalResources:o,capacityOfNewlyProducedPhones:a,capacityOfPhonesInUse:n,capacityOfRecycledMaterials:i,capacityOfRefurbishedPhones:s,capacityOfRepairedPhones:l,phonesInUse:c,supplyOfBrokenPhones:u,supplyOfDisposedPhones:d,supplyOfHibernatingPhones:p,supplyOfNaturalResources:f,supplyOfNewlyProducedPhones:m,supplyOfRecycledMaterials:h,supplyOfRefurbishedPhones:g,supplyOfRepairedPhones:y}=e,{abandonExcessRate:b,abandonRate:S,acquireRate:_,breakRate:k,capacityAdjustmentRate:x,disposeIncentive:C,disposeRate:P,landfillIncentive:T,landfillRate:E,naturalResourceMiningRate:I,naturalResourcesIncentive:M,newPhoneProductionRate:R,newlyProducedPhoneIncentive:O,numberOfUsers:A,phonesPerUserGoal:w,recycleRate:N,recyclingIncentive:B,refurbishmentIncentive:D,refurbishmentRate:j,repairIncentive:L,repairRate:V,reuseIncentive:F,userdata:G}=t,U=A*w,q=Math.max(c-U,0),H=S*c+b*q,z=k*c,$=Math.min(Math.max(0,n-c+z+H),U),W=_*Math.min(m,$),K=_*Math.min($,g),Q=_*Math.min($,y),Y=F/(F+D+C)*p,X=_*Math.min(Y,$),J=Math.max(a-m+W,0),Z=M/(M+B)*J,ee=F+L+D+O,et=O/ee*$,er=B/(M+B)*J,eo=D/ee*$,ea=C/(L+C)*u,en=C/(F+D+C)*p,ei=T/(B+T)*d,es=E*ei,el=R*Math.min(f,J),ec=Math.max(o-f+el,0),eu=R*Math.min(J,h),ed=B/(B+T)*d,ep=Math.max(i-h+eu,0),ef=N*Math.min(ed,ep),em=D/(F+D+C)*p,eh=Math.max(s-g+K,0),ev=j*Math.min(em,eh),eg=L/(L+C)*u,ey=Math.max(l-y+Q,0),eb=V*Math.min(eg,ey),eS=L/ee*$,e_=X+(eb+Q)/2+(ev+Q)/2+(ef+eu)/2,ek=(el+es)/2;return{t:r,stocks:e,parameters:t,variables:{circularityScore:Math.max(Math.min(e_/(Math.abs(e_+ek)+2220446049250313e-31),1),0),coverageScore:c/U,demandForMining:ec,demandForNaturalResources:Z,demandForNewlyProducedPhones:et,demandForPhones:$,demandForRecycledMaterials:er,demandForRecycling:ep,demandForRefurbishedPhones:eo,demandForRefurbishment:eh,demandForRepair:ey,demandForRepairedPhones:eS,demandForResources:J,demandForReusedPhones:F/ee*$,inflowIncentiveSumForPhonesInUse:ee,phoneGoal:U,phonesInUseExcess:q,supplyOfBrokenPhonesForDisposal:ea,supplyOfBrokenPhonesForRepair:eg,supplyOfDisposedPhonesForLandfilling:ei,supplyOfDisposedPhonesForRecycling:ed,supplyOfHibernatingPhonesForDisposal:en,supplyOfHibernatingPhonesForRefurbishment:em,supplyOfHibernatingPhonesForReuse:Y,weightedSumOfBadFlows:ek,weightedSumOfGoodFlows:e_},flows:{abandon:H,acquireNewlyProduced:W,acquireRefurbished:K,acquireRepaired:Q,acquireUsed:X,capacityOfNaturalResourcesAdjustment:x*(Z-o),capacityOfNewlyProducedPhonesAdjustment:x*(et-a),capacityOfPhonesInUseAdjustment:x*(U-n),capacityOfRecycledMaterialsAdjustment:x*(er-i),capacityOfRefurbishedPhonesAdjustment:x*(eo-s),disposeBroken:P*ea,disposeHibernating:P*en,goBroken:z,landfill:es,mineNaturalResources:I*ec,produceFromNaturalResources:el,produceFromRecycledMaterials:eu,recycle:ef,refurbish:ev,repair:eb,repairShopCapcityAdjustment:x*(eS-l)}}}// eslint-disable-next-line class-methods-use-this
accumulateFlowsPerStock(e){/* eslint-disable @typescript-eslint/no-unused-vars */let{abandon:t,acquireNewlyProduced:r,acquireRefurbished:o,acquireRepaired:a,acquireUsed:n,capacityOfNaturalResourcesAdjustment:i,capacityOfNewlyProducedPhonesAdjustment:s,capacityOfPhonesInUseAdjustment:l,capacityOfRecycledMaterialsAdjustment:c,capacityOfRefurbishedPhonesAdjustment:u,disposeBroken:d,disposeHibernating:p,goBroken:f,landfill:m,mineNaturalResources:h,produceFromNaturalResources:g,produceFromRecycledMaterials:y,recycle:b,refurbish:S,repair:_,repairShopCapcityAdjustment:k}=e;return{capacityOfNaturalResources:i,capacityOfNewlyProducedPhones:s,capacityOfPhonesInUse:l,capacityOfRecycledMaterials:c,capacityOfRefurbishedPhones:u,capacityOfRepairedPhones:k,phonesInUse:r+o+a+n-(t+f),supplyOfBrokenPhones:f-(d+_),supplyOfDisposedPhones:d+p-(m+b),supplyOfHibernatingPhones:t-(n+p+S),supplyOfNaturalResources:h-g,supplyOfNewlyProducedPhones:g+y-r,supplyOfRecycledMaterials:b-y,supplyOfRefurbishedPhones:S-o,supplyOfRepairedPhones:_-a}}}}),c("jRMUH",function(e,t){r(e.exports,"Model",function(){return a});var o=l("4E5XB");class a{static #e=this.elementIds=["stocks","parameters","variables","flows"];constructor(e,t,r,o){this.stockIds=e,this.flowIds=t,this.variableIds=r,this.parameterIds=o}static elementObjectToArray(e,t){return e.map(e=>t[e])}static arrayToElementObject(e,t){let r={};for(let o=0;o<e.length;o+=1){let a=e[o];r[a]=t[o]}return r}stocksToStockArray(e){return a.elementObjectToArray(this.stockIds,e)}stockArrayToStocks(e){return a.arrayToElementObject(this.stockIds,e)}flowsToFlowArray(e){return a.elementObjectToArray(this.flowIds,e)}flowArrayToFlows(e){return a.arrayToElementObject(this.flowIds,e)}variablesToVariableArray(e){return a.elementObjectToArray(this.variableIds,e)}variableArrayToVariables(e){return a.arrayToElementObject(this.variableIds,e)}parametersToParameterArray(e){return a.elementObjectToArray(this.parameterIds,e)}parameterArrayToParameters(e){return a.arrayToElementObject(this.parameterIds,e)}evaluateFlowPerStock(e,t,r){let{flows:o}=this.evaluate(e,t,r);return this.accumulateFlowsPerStock(o)}createFlowEvaluator(e){return(t,r)=>{let o=this.stockArrayToStocks(t),a=this.evaluateFlowPerStock(o,e,r),n=this.stocksToStockArray(a);return n}}step(e,t,r,a){let n=this.stocksToStockArray(e),i=(0,o.step)(n,t,r,a);return this.stockArrayToStocks(i)}}}),c("4E5XB",function(e,t){r(e.exports,"step",function(){return a});var o=l("3h2ov");function a(e,t,r,a,n,i){return"number"==typeof t?(0,o.step)(e,t,r,a,n):function(e,t,r,a,n,i){let s=[...t];return(0,o.step)(e,r,a,(e,t)=>t===r?s:n(e,t),i)}(e,t,r,a,n,i)}}),c("3h2ov",function(e,t){r(e.exports,"step",function(){return a}),r(e.exports,"converge",function(){return n});var o=l("555Ja");function a(e,t,r,a,n=o.rk4){return n(e,t,r,a)}function n(e,t,r,a,n,i=o.rk4){let s=0,{userdata:l,done:c}=n(e,t,void 0,0);if(!c){let o,u=t;do o=i(o??e,u,r,a),u+=r,s+=1,{userdata:l,done:c}=n(o,u,l,s);while(!c)}return l}}),c("555Ja",function(e,t){r(e.exports,"rk4",function(){return o});function o(e,t,r,o){let a=e.length,n=o(e,t),i=Array(a),s=r/2,l=r/6,c=t+s;for(let t=0;t<a;t+=1)i[t]=e[t]+s*n[t];let u=o(i,c);for(let t=0;t<a;t+=1)i[t]=e[t]+s*u[t];let d=o(i,c);for(let t=0;t<a;t+=1)i[t]=e[t]+r*d[t],d[t]+=u[t];u=o(i,t+r);for(let t=0;t<a;t+=1)i[t]=e[t]+l*(n[t]+u[t]+2*d[t]);return i}}),c("5rTuK",function(e,t){r(e.exports,"useParameterTransformsStore",function(){return u});var o=l("kV0Ly"),a=l("djimy"),n=l("aDsGb"),i=l("k6FcS"),s=l("7dQGn");function c({id:e,script:t}){let r=(0,a.ref)(t),o=(0,a.computed)(()=>(function(e,t){e.forEach(e=>{if(!(0,i.isVarName)(e))throw Error(`Parameter name '${e}' can not be used as a variable`)});// eslint-disable-next-line @typescript-eslint/no-implied-eval
    let r=Function(t).toString(),o=Function(`{ ${e.join(", ")} }`,`(${r})(); return { ${e.join(", ")} }`);return e=>{let t=o(e);return Object.assign(e,t),e}})(n.parameterIds,r.value));return{id:e,script:r,transform:o}}let u=(0,o.defineStore)("parameter-transforms",()=>{let{config:e}=(0,s.useConfigStore)(),t=(0,a.reactive)(e.parameterTransforms.map(e=>(0,a.reactive)(c(e))));return{parameterTransforms:t,addOrModify:(e,r)=>{let o=t.findIndex(t=>t.id===e);if(-1===o){let o=c({id:e,script:r});t.push((0,a.reactive)(o))}else t[o].script=r},move:(e,r)=>{let[o]=t.splice(e,1);t.splice(r,0,o)},remove:e=>{let r=t.findIndex(t=>t.id===e);-1!==r&&t.splice(r,1)},replaceAll:e=>{let r=e.map(e=>(0,a.reactive)(c(e)));t.splice(0,t.length,...r)}}})}),c("k6FcS",function(e,t){r(e.exports,"isVarName",function(){return o});function o(e){return"string"==typeof e&&e.trim()===e&&null!==e.match(/^[a-zA-Z_][a-zA-Z0-9_]*$/)}}),c("cIjax",function(e,t){r(e.exports,"useParameterTransformId",function(){return u}),r(e.exports,"useSlotGroupsStore",function(){return f});var o=l("kV0Ly"),a=l("djimy"),n=l("gK2p2"),i=l("7dQGn"),s=l("5rTuK"),c=l("6clsW");function u(e){let t=(0,n.default)();return(0,a.reactive)({id:e,uuid:t,active:!1,setActive(e){this.active!==e&&(this.active=e)}})}function d(){let e=(0,s.useParameterTransformsStore)(),t=(0,a.reactive)(e.parameterTransforms.map(({id:e})=>u(e)));return{id:"internal",parameterTransforms:t}}function p(e){let{type:t}=e;switch(t){case"basic":return function(e){let{id:t}=e,r=(0,a.reactive)(e.parameterTransformIds.map(u));return{id:t,parameterTransforms:r}}(e);case"action-card":return function(e){let{id:t}=e,r=(0,a.reactive)(e.cards.map(({parameterTransformId:e})=>u(e)));return{id:t,parameterTransforms:r}}(e);case"event-card":return function(e){let{id:t}=e,r=(0,a.reactive)(e.cards.map(({parameterTransformId:e})=>u(e)));return{id:t,parameterTransforms:r}}(e);default:return(0,c.exhaustiveGuard)(t)}}let f=(0,o.defineStore)("slot-groups",()=>{let{config:e}=(0,i.useConfigStore)(),t=d(),r=e.interaction.slotGroups.map(p),o=[t,...r];return{slotGroups:o,internalSlotGroup:t,nonInternalSlotGroups:r,rebuildInternalSlotGroup:()=>{t.parameterTransforms.splice(0,t.parameterTransforms.length,...d().parameterTransforms)}}})}),c("dNJei",function(e,t){r(e.exports,"Scores",function(){return o});class o{static circularity(e){return e.variables.circularityScore}static coverage(e){return e.variables.coverageScore}static all(e){let t=o.circularity(e),r=o.coverage(e);return{circularity:t,coverage:r}}}}),c("dGm9e",function(e,t){r(e.exports,"render",function(){return u});var o=l("djimy");let a={class:"score-content"},n={class:"score-labels"},i={class:"primary-text"},s={class:"secondary-text"},c=["data-raw-score"];function u(e,t,r,l,u,d){return(0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(l.scores,({id:e,score:t,primaryLabel:r,secondaryLabel:u,cssClasses:d,boundaries:p})=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:e,class:(0,o.normalizeClass)(d)},[(0,o.createElementVNode)("div",a,[(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,(0,o.toDisplayString)(r.value),1),(0,o.createElementVNode)("div",s,(0,o.toDisplayString)(u.value),1)]),(0,o.createElementVNode)("div",{class:"primary-text score-value","data-raw-score":t.value},(0,o.toDisplayString)(l.format(t.value,p)),9,c)])],2))),128)}}),c("2uhUo",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("lbosM",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("4rVEm")).__esModule&&(o=o.default),o.render=l("hT9Bb").render,o.__cssModules={},l("9nPpA").default(o),o.__scopeId="data-v-88ca19",o.__file="ControlPanel.vue";var a=o}),c("4rVEm",function(e,o){t(e.exports),r(e.exports,"default",function(){return p});var a=l("djimy"),n=l("1jdKh"),i=l("iTpok"),s=l("3PxCe"),c=l("LU3Tp"),u=l("c1iJh"),d=l("d1qRQ"),p=/*#__PURE__*/(0,a.defineComponent)({__name:"ControlPanel",props:{disabled:Boolean},setup(e,{expose:t}){t();let r=(0,a.ref)(!0),o=(0,a.ref)(!0),l={props:e,diagramsTabDisabled:r,rawDataTabDisabled:o,ControlPanelTabInitialParameters:n.default,ControlPanelTabParameterTransforms:i.default,ControlPanelTabCharts:s.default,ControlPanelTabRawData:c.default,ControlPanelTabImportExport:u.default,ControlPanelTabMisc:d.default};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}})}),c("1jdKh",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("6swzs")).__esModule&&(o=o.default),o.render=l("hqass").render,o.__cssModules={},l("HR4Xa").default(o),o.__scopeId="data-v-da743b",o.__file="ControlPanelTabInitialParameters.vue";var a=o}),c("6swzs",function(e,o){t(e.exports),r(e.exports,"default",function(){return u});var a=l("djimy"),n=l("kV0Ly"),i=l("9OMm5"),s=l("i5N9G"),c=l("aDsGb"),u=/*#__PURE__*/(0,a.defineComponent)({__name:"ControlPanelTabInitialParameters",setup(e,{expose:t}){t();let r=(0,s.useModelStore)(),o=(0,i.toReactive)((0,n.storeToRefs)(r).initialParameters),a={modelStore:r,initialParameters:o,get parameterIds(){return c.parameterIds}};return Object.defineProperty(a,"__isScriptSetup",{enumerable:!1,value:!0}),a}})}),c("hqass",function(e,t){r(e.exports,"render",function(){return n});var o=l("djimy");let a=["onUpdate:modelValue"];function n(e,t,r,n,i,s){return(0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.parameterIds,e=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:e},[(0,o.createElementVNode)("div",null,(0,o.toDisplayString)(e)+" = "+(0,o.toDisplayString)(n.initialParameters[e]),1),(0,o.withDirectives)((0,o.createElementVNode)("input",{type:"range",min:"0",max:"4",step:"0.001","onUpdate:modelValue":t=>n.initialParameters[e]=t},null,8,a),[[o.vModelText,n.initialParameters[e],void 0,{number:!0}]])]))),128)}}),c("HR4Xa",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("iTpok",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("2eFwL")).__esModule&&(o=o.default),o.render=l("f0bUl").render,o.__cssModules={},l("4Of6y").default(o),o.__scopeId="data-v-c84887",o.__file="ControlPanelTabParameterTransforms.vue";var a=o}),c("2eFwL",function(e,o){t(e.exports),r(e.exports,"default",function(){return d});var a=l("djimy"),n=l("hWymx"),i=l("aWxmM"),s=l("i5N9G"),c=l("5rTuK"),u=l("cIjax"),d=/*#__PURE__*/(0,a.defineComponent)({__name:"ControlPanelTabParameterTransforms",setup(e,{expose:t}){t();let{transformedParametersExt:r}=(0,s.useModelStore)(),o=(0,c.useParameterTransformsStore)(),{slotGroups:l,nonInternalSlotGroups:d,internalSlotGroup:p}=(0,u.useSlotGroupsStore)(),f=(0,a.ref)(""),m=(0,a.ref)("");function h(e,t){o.move(e,t)}let g=(0,a.ref)(null);(0,a.onMounted)(()=>{(0,n.strict)(g.value),(0,i.default).create(g.value,{onEnd:e=>{let{newDraggableIndex:t,oldDraggableIndex:r}=e;(0,n.strict)(void 0!==t),(0,n.strict)(void 0!==r),h(r,t)}})});let y={transformedParametersExt:r,parameterTransformsStore:o,slotGroups:l,nonInternalSlotGroups:d,internalSlotGroup:p,newId:f,newScript:m,select:function({id:e}){f.value=e,m.value=o.parameterTransforms.find(t=>t.id===e)?.script??""},addOrModify:function(e,t){o.addOrModify(e,t);let r=p.parameterTransforms.findIndex(t=>t.id===e);if(-1===r){// The parameter transform is not yet in the internal slot group, so we add it
let t=(0,u.useParameterTransformId)(e);p.parameterTransforms.push(t)}},remove:function(e){let t=-1!==d.flatMap(({parameterTransforms:e})=>e).findIndex(t=>t.id===e);if(t){// eslint-disable-next-line no-alert
alert("Cannot remove parameter transform that is still used in a non-internal slot group");return}let r=()=>p.parameterTransforms.findIndex(t=>t.id===e);for(let e=r();-1!==e;e=r())p.parameterTransforms.splice(e,1);o.remove(e)},move:h,deactivateAllInternal:function(){p.parameterTransforms.forEach(e=>{// eslint-disable-next-line no-param-reassign
e.active=!1})},createTooltip:(e,t)=>{let o=l.findIndex(t=>t===e);(0,n.strict)(-1!==o);let a=r[o],i=e.parameterTransforms.findIndex(e=>e===t);(0,n.strict)(-1!==i);let s=a.steps[i],{active:c,script:u,diff:d}=s;return c?`Diff: ${JSON.stringify(d,null,2)}

Script:
${u}`:`Script:
${u}`},availableContainer:g};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}})}),c("f0bUl",function(e,t){r(e.exports,"render",function(){return P});var o=l("djimy");let a={id:"parameter-transforms",class:"parameter-transforms"},n={ref:"availableContainer",class:"available"},i=["id","data-id","title"],s={class:"draggable"},c=["name","value","onUpdate:modelValue"],u={class:"draggable"},d=["onClick"],p=/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1),f=/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1),m=/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1),h=/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1),g=/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1),y={class:"slot-group-transforms"},b=["data-id"],S=/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1),_={class:"available"},k=["data-id","title"],x=["name","value","onUpdate:modelValue"],C=["onClick"];function P(e,t,r,l,P,T){return(0,o.openBlock)(),(0,o.createElementBlock)("div",a,[(0,o.createElementVNode)("div",null,[(0,o.createTextVNode)(" Internal (applied first): "),(0,o.createElementVNode)("div",n,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(l.internalSlotGroup.parameterTransforms,e=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"parameter-transform",key:e.uuid,id:e.uuid,"data-id":e.id,title:l.createTooltip(l.internalSlotGroup,e)},[(0,o.createElementVNode)("label",s,[(0,o.withDirectives)((0,o.createElementVNode)("input",{type:"checkbox",name:e.id,value:e.id,"onUpdate:modelValue":t=>e.active=t},null,8,c),[[o.vModelCheckbox,e.active]]),(0,o.createElementVNode)("span",u,(0,o.toDisplayString)(e.id),1)]),(0,o.createElementVNode)("span",{class:"edit",onClick:t=>l.select(e)},"✎",8,d)],8,i))),128))],512),p,(0,o.createElementVNode)("input",{type:"button",value:"Deactivate active internal transforms",onClick:t[0]||(t[0]=e=>l.deactivateAllInternal())})]),(0,o.createElementVNode)("div",null,[(0,o.createElementVNode)("div",null,[(0,o.createTextVNode)(" Id:"),f,(0,o.withDirectives)((0,o.createElementVNode)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>l.newId=e),name:"parameter-transform-id"},null,512),[[o.vModelText,l.newId]]),m,(0,o.createTextVNode)(" Script:"),h,(0,o.withDirectives)((0,o.createElementVNode)("textarea",{"onUpdate:modelValue":t[2]||(t[2]=e=>l.newScript=e),rows:"5",cols:"10",name:"parameter-transform-script"},null,512),[[o.vModelText,l.newScript]]),g,(0,o.createElementVNode)("input",{type:"button",value:"Add/Modify",onClick:t[3]||(t[3]=e=>l.addOrModify(l.newId,l.newScript))}),(0,o.createElementVNode)("input",{type:"button",value:"Delete",onClick:t[4]||(t[4]=e=>l.remove(l.newId))})]),(0,o.createElementVNode)("div",y,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(l.nonInternalSlotGroups,e=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:e.id,"data-id":e.id},[S,(0,o.createTextVNode)(" Slot group '"+(0,o.toDisplayString)(e.id)+"': ",1),(0,o.createElementVNode)("div",_,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.parameterTransforms,t=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t.uuid,"data-id":t.id,title:l.createTooltip(e,t)},[(0,o.createElementVNode)("label",null,[(0,o.withDirectives)((0,o.createElementVNode)("input",{type:"checkbox",name:t.id,value:t.id,"onUpdate:modelValue":e=>t.active=e,disabled:""},null,8,x),[[o.vModelCheckbox,t.active]]),(0,o.createTextVNode)((0,o.toDisplayString)(t.id),1)]),(0,o.createElementVNode)("span",{class:"edit",onClick:e=>l.select(t)},"✎",8,C)],8,k))),128))])],8,b))),128))])])])}}),c("4Of6y",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("3PxCe",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("4KeeH")).__esModule&&(o=o.default),o.render=l("fqpjM").render,l("aJLcO").default(o),o.__scopeId="data-v-ff532a",o.__file="ControlPanelTabCharts.vue";var a=o}),c("4KeeH",function(e,o){t(e.exports),r(e.exports,"default",function(){return u});var a=l("djimy"),n=l("hWymx"),i=l("dbRyT"),s=l("i5N9G"),c=l("aDsGb"),u=/*#__PURE__*/(0,a.defineComponent)({__name:"ControlPanelTabCharts",props:{disabled:Boolean},setup(e,{expose:t}){function r(e){return(0,c.CircularEconomyModel).elementIds.map(t=>Object.entries(e[t]).map(([e,t])=>({id:e,value:t}))).reduce((e,t)=>[...e,...t],[])}t(),(0,i.Chart).register(i.BarController,i.Title,i.Tooltip,i.Legend,i.BarElement,i.CategoryScale,i.LinearScale);let o=(0,s.useModelStore)(),l={stocks:c.stockIds,flows:c.flowIds,variables:c.variableIds,parameters:c.parameterIds},u=Object.values(l).flat(),d=(0,a.ref)(null);(0,a.onMounted)(()=>{(0,n.strict)(d.value);let t=new i.Chart(d.value,{type:"bar",data:{labels:u,datasets:[{label:"Values",data:Array(u.length).fill(0)}]},options:{animation:!1}});(0,a.watchEffect)(()=>{if(e.disabled)return;let a=r(o.record);t.data.datasets[0].data=a.map(e=>e.value),t.update()})});let p={props:e,toChartJsRecord:r,modelStore:o,labels:l,labelsArray:u,canvas:d};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}})}),c("fqpjM",function(e,t){r(e.exports,"render",function(){return i});var o=l("djimy");let a={style:{width:"100%"}},n={ref:"canvas"};function i(e,t,r,i,s,l){return(0,o.openBlock)(),(0,o.createElementBlock)("div",a,[(0,o.createElementVNode)("canvas",n,null,512)])}}),c("aJLcO",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("LU3Tp",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("7ApkJ")).__esModule&&(o=o.default),o.render=l("9Iuzd").render,o.__cssModules={},l("fGK4y").default(o),o.__scopeId="data-v-1b3f28",o.__file="ControlPanelTabRawData.vue";var a=o}),c("7ApkJ",function(e,o){t(e.exports),r(e.exports,"default",function(){return c});var a=l("djimy"),n=l("i5N9G"),i=l("jRMUH"),s=l("dNJei"),c=/*#__PURE__*/(0,a.defineComponent)({__name:"ControlPanelTabRawData",props:{disabled:Boolean},setup(e,{expose:t}){t();let r=(0,n.useModelStore)(),o=(0,a.computed)(()=>(0,s.Scores).all(r.record)),l=e=>{let t=10**e;return(e,r)=>"number"==typeof r?Math.round(r*t)/t:r},c=l(2),u=l(3),d={props:e,modelStore:r,scores:o,createFormatter:l,format2:c,format3:u,get Model(){return i.Model}};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}})}),c("9Iuzd",function(e,t){r(e.exports,"render",function(){return i});var o=l("djimy");let a={key:0,class:"container"},n={class:"preformatted"};function i(e,t,r,i,s,l){return i.props.disabled?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("div",a,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(i.Model.elementIds,e=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:e,class:"preformatted"},(0,o.toDisplayString)(`${e}: ${JSON.stringify(i.modelStore.record[e],i.format2,2)}`),1))),128)),(0,o.createElementVNode)("div",n,(0,o.toDisplayString)(`scores: ${JSON.stringify(i.scores,i.format3,2)}`),1)]))}}),c("fGK4y",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("c1iJh",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("jVwA8")).__esModule&&(o=o.default),o.render=l("gpQtt").render,o.__cssModules={},l("dtadU").default(o),o.__scopeId="data-v-637161",o.__file="ControlPanelTabImportExport.vue";var a=o}),c("jVwA8",function(e,o){t(e.exports),r(e.exports,"default",function(){return f});var a=l("djimy"),n=l("jTevu"),i=l("5rTuK"),s=l("cIjax"),c=l("7dQGn"),u=l("i5N9G"),d=l("krAM6"),p=l("coVQp"),f=/*#__PURE__*/(0,a.defineComponent)({__name:"ControlPanelTabImportExport",setup(e,{expose:t}){t();let{config:r}=(0,c.useConfigStore)(),o=(0,i.useParameterTransformsStore)(),{parameterTransforms:l}=o,{rebuildInternalSlotGroup:f}=(0,s.useSlotGroupsStore)(),{initialParameters:m,transformedParametersExt:h}=(0,u.useModelStore)(),g={SUCCESS:0,UNPROCESSED:1,UNKNOWN:2,ERROR:3},y={[g.SUCCESS]:"Successfully imported.",[g.UNPROCESSED]:"",[g.UNKNOWN]:"Unknown import state. Please check the developer console.",[g.ERROR]:"Failed to import. Please check the developer console."},b=(0,a.ref)(""),S=(0,a.ref)(g.UNPROCESSED),_=(0,a.ref)(""),k=(0,a.ref)(g.UNPROCESSED);function x(e){try{let t=(0,n.default).load(e)??{},o=(0,p.ConfigLoader).merge(structuredClone((0,a.toRaw)(r)),t),i=(0,d.validateConfig)(o);if(!i.ok){/* eslint-disable no-console */let{error:{errors:e,explanation:t}}=i;return console.error("Invalid configuration:",o),console.error(t),console.error("Issues reported by the configuration validator:",...e??[]),null}return i.data}catch(e){return console.error("Failed to parse YAML:",e),null}}async function C(){let e=x(b.value);if(S.value=null===e?g.ERROR:g.UNKNOWN,!e)return;let{parameterTransforms:t}=e,r=new Promise(e=>{(0,a.watch)(h,e,{deep:!0,once:!0})});o.replaceAll(t),f(),await r,S.value=g.SUCCESS}let P={config:r,parameterTransformsStore:o,parameterTransforms:l,rebuildInternalSlotGroup:f,initialParameters:m,transformedParametersExt:h,OState:g,stateTooltips:y,parameterTransformsYamlText:b,parameterTransformImportState:S,initialParametersYamlText:_,initialParametersImportState:k,deriveConfig:x,importInitialParameters:function(){let e=x(_.value);if(k.value=null===e?g.ERROR:g.UNKNOWN,!e)return;let{model:{initialParameters:t}}=e;Object.assign(m,t),k.value=g.SUCCESS},importParameterTransforms:C,exportInitialParameters:function(){k.value=g.UNPROCESSED,_.value=(0,n.default).dump({model:{initialParameters:m}}),console.log(_.value)},exportParameterTransforms:function(){S.value=g.UNPROCESSED;let e={parameterTransforms:l.map(({id:e,script:t})=>({id:e,script:t}))};b.value=(0,n.default).dump(e),console.log(b.value)}};return Object.defineProperty(P,"__isScriptSetup",{enumerable:!1,value:!0}),P}})}),c("krAM6",function(e,t){r(e.exports,"validateConfig",function(){return s});var o=l("Clc2s"),a=l("ke2S4");l("bepfO");let n=a.SuretypeConfigSchema,i=(0,o.compile)(n);(0,o.compile)(n,{ensure:!0}),(0,o.compile)(n,{simple:!0});let s=e=>{let t=i(e);if(!t.ok){let{errors:e,explanation:r}=t;return{ok:!1,error:{errors:e,explanation:r}}}return{ok:!0,data:e}}}),c("ke2S4",function(e,t){r(e.exports,"SuretypeConfigSchema",function(){return D});var o=l("Clc2s"),a=l("eU4UV"),n=l("aDsGb");let i=(0,o.v).string().matches(a.POSITIONAL_ASSET_REGEX),s=(0,o.suretype)({name:"AssetUrlObjectConfig",title:"Asset URL object"},(0,o.v).object({url:i.required()}).additional(!1)),c=(0,o.v).string().enum(...Object.values(a.BUILTIN_LAYER_NAMES)),u=(0,o.suretype)({name:"I18nConfig",title:"Internationalized text"},(0,o.v).object({}).additional((0,o.v).string())),d=(0,o.suretype)({name:"ParameterTransformConfig",title:"Parameter transformation"},(0,o.v).object({id:(0,o.v).string().required(),script:(0,o.v).string().required()}).additional(!1).required()),p=(0,o.v).array(d),f=(0,o.suretype)({name:"InitialParametersConfig",title:"Initial parameter values"},(0,o.v).object(Object.fromEntries((0,n.parameterIds).map(e=>[e,(0,o.v).number().required()]))).additional(!1)),m=(0,o.suretype)({name:"InitialStocksConfig",title:"Initial stock values"},(0,o.v).object(Object.fromEntries((0,n.stockIds).map(e=>[e,(0,o.v).number().required()]))).additional(!1)),h=(0,o.suretype)({name:"MarkerSlotConfig",title:"Marker slot"},(0,o.v).object({id:(0,o.v).string().required(),x:(0,o.v).number().required(),y:(0,o.v).number().required(),angle:(0,o.v).number().required()}).additional(!1)),g=(0,o.suretype)({name:"CardSlotConfig",title:"Card slot"},(0,o.v).object({id:(0,o.v).string().required(),x:(0,o.v).number().required(),y:(0,o.v).number().required(),angle:(0,o.v).number().required()}).additional(!1)),y=(0,o.suretype)({name:"CardConfig",title:"Card"},(0,o.v).object({parameterTransformId:(0,o.v).string().required(),url:(0,o.v).string().required()}).additional(!1)),b=(0,o.v).string().matches(/^((?!internal).)*$/g),S=(0,o.suretype)({name:"SlotGroupAssetConfig",title:"Slot group assets"},(0,o.v).object({markerSlotActive:s.required(),markerSlotInactive:s.required()}).additional(!1)),_=(0,o.suretype)({name:"BasicSlotGroupConfig",title:"Basic slot group"},(0,o.v).object({id:b.required(),type:(0,o.v).string().enum("basic").required(),label:u.required(),assets:S.required(),markerSlots:(0,o.v).array(h).required(),parameterTransformIds:(0,o.v).array((0,o.v).string()).required()}).additional(!1)),k=(0,o.suretype)({name:"ActionCardSlotGroupSlotConfig",title:"Action card slot group slot"},(0,o.v).object({markerSlot:h.required(),cardSlot:g.required()}).additional(!1)),x=(0,o.suretype)({name:"ActionCardSlotGroupConfig",title:"Action card slot group"},(0,o.v).object({id:b.required(),type:(0,o.v).string().enum("action-card").required(),label:u.required(),assets:S.required(),slots:(0,o.v).array(k).required(),cards:(0,o.v).array(y).required()}).additional(!1)),C=(0,o.suretype)({name:"EventCardSlotGroupConfig",title:"Event card slot group"},(0,o.v).object({id:b.required(),type:(0,o.v).string().enum("event-card").required(),label:u.required(),assets:S.required(),markerSlot:h.required(),cardSlots:(0,o.v).array(g).required(),cards:(0,o.v).array(y).required()}).additional(!1)),P=(0,o.suretype)({name:"SlotGroupConfig",title:"Slot group"},(0,o.v).anyOf([_,x,C])),T=(0,o.suretype)({name:"BuiltinLayerConfig",title:"Builtin layer"},c),E=(0,o.suretype)({name:"ConditionalLayerConfig",title:"Conditionally shown illustration layer"},(0,o.v).object({url:i.required(),condition:(0,o.v).string().required(),reset:(0,o.v).boolean().default(!1)}).additional(!1).required()),I=(0,o.suretype)({name:"LayerConfig",title:"Illustration or visualization layer"},(0,o.v).anyOf([T,E])),M=(0,o.suretype)({name:"LayersConfig",title:"Layers of illustrations and visualizations"},(0,o.v).array(I).unique(!0)),R=(0,o.suretype)({name:"ScoreLabelsConfig",title:"Score labels"},(0,o.v).object({circularity:u.required(),coverage:u.required()}).additional(!1)),O=(0,o.suretype)({name:"AutoResetConfig",title:"Auto reset"},(0,o.v).object({timeoutSeconds:(0,o.v).number().gte(0).required(),condition:(0,o.v).string().required(),title:u.required(),description:u.required()}).additional(!1)),A=(0,o.suretype)({name:"GeneralConfig",title:"General configuration"},(0,o.v).object({assetBaseDir:(0,o.v).string().required(),primaryLanguage:(0,o.v).string().required(),secondaryLanguage:(0,o.v).string().required(),description:u.required(),scoreLabels:R.required(),autoReset:O.required()}).additional(!1)),w=(0,o.suretype)({name:"InteractionConfig",title:"Interactive elements"},(0,o.v).object({actionCardDelayMs:(0,o.v).number().gte(0).required(),eventCardMinDelayMs:(0,o.v).number().gte(0).required(),eventCardMaxDelayMs:(0,o.v).number().gte(0).required(),eventCardMinDurationMs:(0,o.v).number().gte(0).required(),eventCardMaxDurationMs:(0,o.v).number().gte(0).required(),slotGroups:(0,o.v).array(P).required()}).additional(!1)),N=(0,o.suretype)({name:"ModelConfig",title:"Model configuration"},(0,o.v).object({initialParameters:f.required(),initialStocks:m.required()}).additional(!1)),B=(0,o.suretype)({name:"SimulationConfig",title:"Simulation configuration"},(0,o.v).object({deltaPerSecond:(0,o.v).number().required(),maxStepSize:(0,o.v).number().required()}).additional(!1)),D=(0,o.suretype)({name:"Config",title:"Schema of the app configuration"},(0,o.v).object({general:A.required(),model:N.required(),simulation:B.required(),parameterTransforms:p.required(),interaction:w.required(),layers:M.required()}).additional(!1).required())}),c("eU4UV",function(e,t){r(e.exports,"POSITIONAL_ASSET_REGEX",function(){return o}),r(e.exports,"BUILTIN_LAYER_NAMES",function(){return a});let o=/_x[+-]?[0-9]+_y[+-]?[0-9]+\.[a-zA-Z0-9]+$/g,a={modelVisualization:"modelVisualization",scores:"scores",slots:"slots"}}),c("bepfO",function(e,t){// This file can be used to augment the generated types with additional types or interfaces.
// It is also the one that should be imported elsewhere in the codebase.
l("cbFbI")}),c("cbFbI",function(e,t){/* tslint:disable *//* eslint-disable *//**
 * This file is generated by core-types-ts on behalf of typeconv, DO NOT EDIT.
 * For more information, see:
 *  - {@link https://github.com/grantila/core-types-ts}
 *  - {@link https://github.com/grantila/typeconv}
 */}),c("coVQp",function(e,t){r(e.exports,"ConfigLoader",function(){return d});var a=l("hWymx"),n=l("jTevu"),i=l("fWsyq"),s=l("krAM6"),c=l("jbw4D");function u(e,t){return t}class d{static async fetch(e){let t=await fetch(e);if(!t.ok)throw Error(`Failed to load config file '${e.toString()}': ${t.statusText}`);let r=await t.text(),o=(0,n.default).load(r,{schema:n.default.JSON_SCHEMA});if("object"!=typeof o||null===o)throw Error(`Failed to parse config file '${e.toString()}': ${JSON.stringify(o)}`);return o}static merge(...e){return /*@__PURE__*/o(i).all(e,{arrayMerge:u})}static async safeLoad(...e){let t=await Promise.all(e.map(async e=>[e,await d.fetch(e)])),r=d.merge(...t.map(([e,t])=>t)),o=(0,s.validateConfig)(r);if(!o.ok)return{ok:!1,error:{config:{merged:r,segments:t},error:o.error}};try{return(0,c.checkIdUniqueness)(o.data),{ok:!0,data:o.data}}catch(e){return(0,a.strict)(e instanceof c.DuplicateIdError),{ok:!1,error:{config:{merged:r,segments:t},error:e}}}}static async load(...e){let t=await d.safeLoad(...e);if(!t.ok)throw t.error;return t.data}}}),c("jbw4D",function(e,t){r(e.exports,"DuplicateIdError",function(){return o}),r(e.exports,"checkIdUniqueness",function(){return l});class o extends Error{}function a(e,t){let r=new Set;e.forEach(({id:e},a)=>{if(r.has(e))throw new o(`Duplicate ${t} ID '${e}' at index ${a}`);r.add(e)})}function n(e){return"basic"===e.type}function i(e){return"action-card"===e.type}function s(e){return"event-card"===e.type}function l(e){a(e.parameterTransforms,"parameter transform"),a(e.interaction.slotGroups,"slot group"),function(e){let t=e.interaction.slotGroups,r=t.filter(n),o=t.filter(i),l=t.filter(s),c=[...r.flatMap(({markerSlots:e})=>e),...o.flatMap(({slots:e})=>e.map(({markerSlot:e})=>e)),...l.map(({markerSlot:e})=>e)];a(c,"marker slot")}(e),function(e){let t=e.interaction.slotGroups,r=t.filter(i),o=t.filter(s),n=[...r.flatMap(({slots:e})=>e.map(({cardSlot:e})=>e)),...o.flatMap(({cardSlots:e})=>e)];a(n,"card slot")}(e)}}),c("gpQtt",function(e,t){r(e.exports,"render",function(){return d});var o=l("djimy");let a=e=>((0,o.pushScopeId)("data-v-637161"),e=e(),(0,o.popScopeId)(),e),n=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1)),i=["title"],s=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1)),c=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1)),u=["title"];function d(e,t,r,a,l,d){return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createTextVNode)(" Initial parameters:"),n,(0,o.withDirectives)((0,o.createElementVNode)("textarea",{name:"initialParametersYamlText","onUpdate:modelValue":t[0]||(t[0]=e=>a.initialParametersYamlText=e),rows:"15",cols:"80",class:(0,o.normalizeClass)({success:a.initialParametersImportState===a.OState.SUCCESS,error:a.initialParametersImportState===a.OState.ERROR}),title:a.stateTooltips[a.initialParametersImportState],onInput:t[1]||(t[1]=e=>a.initialParametersImportState=a.OState.UNPROCESSED)},null,42,i),[[o.vModelText,a.initialParametersYamlText]]),(0,o.createElementVNode)("div",null,[(0,o.createElementVNode)("input",{type:"button",value:"Import",onClick:t[2]||(t[2]=e=>a.importInitialParameters())}),(0,o.createElementVNode)("input",{type:"button",value:"Export",onClick:t[3]||(t[3]=e=>a.exportInitialParameters())})]),s,(0,o.createTextVNode)(" Parameter transforms:"),c,(0,o.withDirectives)((0,o.createElementVNode)("textarea",{name:"parameterTransformYamlText","onUpdate:modelValue":t[4]||(t[4]=e=>a.parameterTransformsYamlText=e),rows:"15",cols:"80",class:(0,o.normalizeClass)({success:a.parameterTransformImportState===a.OState.SUCCESS,unknown:a.parameterTransformImportState===a.OState.UNKNOWN,error:a.parameterTransformImportState===a.OState.ERROR}),title:a.stateTooltips[a.parameterTransformImportState],onInput:t[5]||(t[5]=e=>a.parameterTransformImportState=a.OState.UNPROCESSED)},null,42,u),[[o.vModelText,a.parameterTransformsYamlText]]),(0,o.createElementVNode)("div",null,[(0,o.createElementVNode)("input",{type:"button",value:"Import",onClick:t[6]||(t[6]=e=>a.importParameterTransforms())}),(0,o.createElementVNode)("input",{type:"button",value:"Export",onClick:t[7]||(t[7]=e=>a.exportParameterTransforms())})])],64)}}),c("dtadU",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("d1qRQ",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("e1eyS")).__esModule&&(o=o.default),o.render=l("5Fgja").render,o.__cssModules={},l("kdosU").default(o),o.__scopeId="data-v-31cd2e",o.__file="ControlPanelTabMisc.vue";var a=o}),c("e1eyS",function(e,o){t(e.exports),r(e.exports,"default",function(){return d});var a=l("djimy"),n=l("gK2p2"),i=l("7Rjir"),s=l("f4LB1"),c=l("i5N9G"),u=l("5f8hv"),d=/*#__PURE__*/(0,a.defineComponent)({__name:"ControlPanelTabMisc",setup(e,{expose:t}){t();let r=(0,n.default)(),o=`btn-toggle-playing-${r}`,a=`btn-toggle-fullscreen-${r}`,l=`btn-toggle-dev-mode-${r}`,d=`btn-toggle-highlight-derivatives-${r}`,p=`btn-toggle-marker-slot-labels-${r}`,f=`btn-toggle-auto-reset-${r}`,m=(0,s.useAppStore)(),h=(0,c.useModelStore)(),g=(0,u.useVisualizationStore)(),y=Object.keys(g.scaleFactors),b={uuid:r,togglePlayingBtnId:o,toggleFullscreenBtnId:a,toggleDeveloperModeBtnId:l,toggleHighlightDerivativesBtnId:d,toggleMarkerSlotLabelsBtnId:p,toggleAutoResetBtnId:f,appStore:m,modelStore:h,visualizationStore:g,togglePlaying:()=>m.$patch({isPlaying:!m.isPlaying}),toggleFullscreen:()=>m.$patch({isFullscreen:!m.isFullscreen}),toggleDeveloperMode:()=>m.$patch({isDeveloperModeActive:!m.isDeveloperModeActive}),toggleHighlightDerivatives:()=>m.$patch({highlightDerivatives:!m.highlightDerivatives}),toggleMarkerSlotLabels:()=>m.$patch({showMarkerSlotLabels:!m.showMarkerSlotLabels}),resetModel:()=>h.reset(),toggleAutoReset:()=>{m.$patch({autoReset:!m.autoReset})},scaleFactorKeys:y,get HOTKEYS(){return i.HOTKEYS}};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}})}),c("5f8hv",function(e,t){r(e.exports,"useVisualizationStore",function(){return n});var o=l("kV0Ly"),a=l("djimy");let n=(0,o.defineStore)("visualization",()=>{let e=(0,a.ref)({stock:3e4,stockHighlight:1,flow:.4,flowHighlight:10});return{scaleFactors:e}})}),c("5Fgja",function(e,t){r(e.exports,"render",function(){return g});var o=l("djimy");let a=e=>((0,o.pushScopeId)("data-v-31cd2e"),e=e(),(0,o.popScopeId)(),e),n=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1)),i=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1)),s=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1)),c=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1)),u=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1)),d=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1)),p=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("br",null,null,-1)),f={class:"scale-factors"},m=["for"],h=["id","onUpdate:modelValue"];function g(e,t,r,a,l,g){return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createElementVNode)("input",{type:"checkbox",class:(0,o.normalizeClass)(["btn-check",()=>a.appStore.isFullscreen?"active":""]),id:a.togglePlayingBtnId,autocomplete:"off",onClick:a.togglePlaying},null,2),(0,o.createElementVNode)("label",{class:"btn btn-primary",for:a.togglePlayingBtnId},"Run ("+(0,o.toDisplayString)(a.HOTKEYS.run.label)+")",1),n,(0,o.createElementVNode)("input",{type:"checkbox",class:(0,o.normalizeClass)(["btn-check",()=>a.appStore.isFullscreen?"active":""]),id:a.toggleFullscreenBtnId,autocomplete:"off"},null,2),(0,o.createElementVNode)("label",{class:"btn btn-primary",for:a.toggleFullscreenBtnId,onClick:a.toggleFullscreen},"Fullscreen ("+(0,o.toDisplayString)(a.HOTKEYS.fullscreen.label)+")",1),i,(0,o.createElementVNode)("input",{type:"checkbox",class:(0,o.normalizeClass)(["btn-check",()=>a.appStore.isDeveloperModeActive?"active":""]),id:a.toggleDeveloperModeBtnId,autocomplete:"off"},null,2),(0,o.createElementVNode)("label",{class:"btn btn-primary",for:a.toggleDeveloperModeBtnId,onClick:a.toggleDeveloperMode},"Developer mode ("+(0,o.toDisplayString)(a.HOTKEYS.developerMode.label)+")",1),s,(0,o.createElementVNode)("input",{type:"checkbox",class:(0,o.normalizeClass)(["btn-check",()=>a.appStore.highlightDerivatives?"active":""]),id:a.toggleHighlightDerivativesBtnId,autocomplete:"off"},null,2),(0,o.createElementVNode)("label",{class:"btn btn-primary",for:a.toggleHighlightDerivativesBtnId,onClick:a.toggleHighlightDerivatives},"Highlight derivatives ("+(0,o.toDisplayString)(a.HOTKEYS.highlightDerivatives.label)+")",1),c,(0,o.createElementVNode)("input",{type:"checkbox",class:(0,o.normalizeClass)(["btn-check",()=>a.appStore.showMarkerSlotLabels?"active":""]),id:a.toggleMarkerSlotLabelsBtnId,autocomplete:"off"},null,2),(0,o.createElementVNode)("label",{class:"btn btn-primary",for:a.toggleMarkerSlotLabelsBtnId,onClick:a.toggleMarkerSlotLabels},"Show marker slot labels"),u,(0,o.createElementVNode)("button",{type:"button",class:"btn btn-primary",onClick:a.resetModel}," Reset model ("+(0,o.toDisplayString)(a.HOTKEYS.reset.label)+")",1),d,(0,o.createElementVNode)("input",{type:"checkbox",class:(0,o.normalizeClass)(["btn-check",()=>a.appStore.autoReset?"active":""]),id:a.toggleAutoResetBtnId,autocomplete:"off"},null,2),(0,o.createElementVNode)("label",{class:"btn btn-primary",for:a.toggleAutoResetBtnId,onClick:a.toggleAutoReset},"Enable auto-reset"),p,(0,o.createElementVNode)("form",f,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.scaleFactorKeys,e=>((0,o.openBlock)(),(0,o.createElementBlock)("p",{key:e},[(0,o.createElementVNode)("label",{for:`viz-scale-factors-${e}-${a.uuid}`},(0,o.toDisplayString)(e)+":",9,m),(0,o.withDirectives)((0,o.createElementVNode)("input",{type:"number",id:`viz-scale-factors-${e}-${a.uuid}`,"onUpdate:modelValue":t=>a.visualizationStore.scaleFactors[e]=t},null,8,h),[[o.vModelText,a.visualizationStore.scaleFactors[e]]])]))),128))])],64)}}),c("kdosU",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("hT9Bb",function(e,t){r(e.exports,"render",function(){return S});var o=l("djimy");let a=e=>((0,o.pushScopeId)("data-v-88ca19"),e=e(),(0,o.popScopeId)(),e),n={class:"control-panel"},i={class:"nav nav-tabs",id:"nav-tab",role:"tablist"},s=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("button",{class:"nav-link",id:"nav-initial-parameters-tab","data-bs-toggle":"tab","data-bs-target":"#nav-initial-parameters",type:"button",role:"tab","aria-controls":"nav-initial-parameters","aria-selected":"false"}," Initial parameters ",-1)),c=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("button",{class:"nav-link active",id:"nav-parameter-transforms-tab","data-bs-toggle":"tab","data-bs-target":"#nav-parameter-transforms",type:"button",role:"tab","aria-controls":"nav-parameter-transforms","aria-selected":"true"}," Parameter transforms ",-1)),u=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("button",{class:"nav-link",id:"nav-import-export-tab","data-bs-toggle":"tab","data-bs-target":"#nav-import-export",type:"button",role:"tab","aria-controls":"nav-import-export","aria-selected":"false"}," Import/Export ",-1)),d=/*#__PURE__*/a(()=>/*#__PURE__*/(0,o.createElementVNode)("button",{class:"nav-link",id:"nav-misc-tab","data-bs-toggle":"tab","data-bs-target":"#nav-misc",type:"button",role:"tab","aria-controls":"nav-misc","aria-selected":"true"}," Misc ",-1)),p={class:"tab-content",id:"nav-tabContent"},f={class:"tab-pane show",id:"nav-initial-parameters",role:"tabpanel","aria-labelledby":"nav-initial-parameters-tab",tabindex:"0"},m={class:"tab-pane show active",id:"nav-parameter-transforms",role:"tabpanel","aria-labelledby":"nav-parameter-transforms-tab",tabindex:"0"},h={class:"tab-pane show",id:"nav-diagrams",role:"tabpanel","aria-labelledby":"nav-diagrams-tab",tabindex:"0"},g={class:"tab-pane show",id:"nav-raw-data",role:"tabpanel","aria-labelledby":"nav-raw-data-tab",tabindex:"0"},y={class:"tab-pane show",id:"nav-import-export",role:"tabpanel","aria-labelledby":"nav-import-export-tab",tabindex:"0"},b={class:"tab-pane show",id:"nav-misc",role:"tabpanel","aria-labelledby":"nav-misc-tab",tabindex:"0"};function S(e,t,r,a,l,S){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:(0,o.normalizeClass)({hidden:a.props.disabled})},[(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("nav",null,[(0,o.createElementVNode)("div",i,[s,c,(0,o.createElementVNode)("button",(0,o.mergeProps)({class:"nav-link",id:"nav-diagrams-tab","data-bs-toggle":"tab","data-bs-target":"#nav-diagrams",type:"button",role:"tab","aria-controls":"nav-diagrams","aria-selected":"false"},(0,o.toHandlers)({"hidden.bs.tab":()=>a.diagramsTabDisabled=!0,"show.bs.tab":()=>a.diagramsTabDisabled=!1},!0))," Diagrams ",16),(0,o.createElementVNode)("button",(0,o.mergeProps)({class:"nav-link",id:"nav-raw-data-tab","data-bs-toggle":"tab","data-bs-target":"#nav-raw-data",type:"button",role:"tab","aria-controls":"nav-raw-data","aria-selected":"false"},(0,o.toHandlers)({"hidden.bs.tab":()=>a.rawDataTabDisabled=!0,"show.bs.tab":()=>a.rawDataTabDisabled=!1},!0))," Raw data ",16),u,d])]),(0,o.createElementVNode)("div",p,[(0,o.createElementVNode)("div",f,[(0,o.createVNode)(a.ControlPanelTabInitialParameters)]),(0,o.createElementVNode)("div",m,[(0,o.createVNode)(a.ControlPanelTabParameterTransforms)]),(0,o.createElementVNode)("div",h,[(0,o.createVNode)(a.ControlPanelTabCharts,{disabled:a.props.disabled||a.diagramsTabDisabled},null,8,["disabled"])]),(0,o.createElementVNode)("div",g,[(0,o.createVNode)(a.ControlPanelTabRawData,{disabled:a.props.disabled||a.rawDataTabDisabled},null,8,["disabled"])]),(0,o.createElementVNode)("div",y,[(0,o.createVNode)(a.ControlPanelTabImportExport)]),(0,o.createElementVNode)("div",b,[(0,o.createVNode)(a.ControlPanelTabMisc)])])])],2)}}),c("9nPpA",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("4TkLj",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("8tP0r")).__esModule&&(o=o.default),o.render=l("3sm7t").render,o.__cssModules={},l("adIs9").default(o),o.__scopeId="data-v-5caec8",o.__file="ConditionalLayer.vue";var a=o}),c("8tP0r",function(e,o){t(e.exports),r(e.exports,"default",function(){return u});var a=l("djimy"),n=l("7dQGn"),i=l("i5N9G"),s=l("8CFAD"),c=l("7Rjir"),u=/*#__PURE__*/(0,a.defineComponent)({__name:"ConditionalLayer",props:{layerConfig:{}},setup(e,{expose:t}){t();let{extractAssetPosition:r,toAssetUrl:o}=(0,n.useConfigStore)(),l=(0,i.useModelStore)();function u({condition:e,url:t,reset:n}){let i=o(t),{x:c,y:u}=r(i),d=(0,s.compile)(e),p=(0,a.computed)(()=>{// If the condition does not depend on the record (e.g. it only depends on some global state like the date),
// the reactive elements of modelStore.record will not be accessed and the condition will never be re-evaluated
// after the first run. Querying the timestamp of the record object ensures that the condition is re-evaluated
// whenever the simulation progresses.
// eslint-disable-next-line @typescript-eslint/no-unused-vars
let{t:e}=l.record;return d(l.record)});return{checkCondition:d,condition:e,active:p,url:i,x:c,y:u,reset:n??!1}}let d=u(e.layerConfig),p={props:e,extractAssetPosition:r,toAssetUrl:o,modelStore:l,compileLayer:u,compiledLayer:d,get TRANSPARENT_PIXEL_DATA_URL(){return c.TRANSPARENT_PIXEL_DATA_URL}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}})}),c("8CFAD",function(e,t){r(e.exports,"compile",function(){return n});var o=l("aDsGb");let a=`{ ${(0,o.CircularEconomyModel).elementIds.join(", ")} }`;function n(e){// eslint-disable-next-line @typescript-eslint/no-implied-eval
return Function(a,`return (${e}) === true;`)}}),c("3sm7t",function(e,t){r(e.exports,"render",function(){return n});var o=l("djimy");let a=["src","alt"];function n(e,t,r,n,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("img",{src:`${n.compiledLayer.reset&&!n.compiledLayer.active.value?n.TRANSPARENT_PIXEL_DATA_URL:n.compiledLayer.url.href}`,class:(0,o.normalizeClass)(["positioned-layer",{inactive:!n.compiledLayer.active.value}]),style:(0,o.normalizeStyle)({"--layer-x":n.compiledLayer.x,"--layer-y":n.compiledLayer.y}),alt:`${n.compiledLayer.condition} -> ${n.compiledLayer.url}`},null,14,a)}}),c("adIs9",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("2vvax",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("eXrNq")).__esModule&&(o=o.default),o.render=l("jtxJg").render,l("eESbR").default(o),o.__scopeId="data-v-11b99f",o.__file="BasicSlotGroup.vue";var a=o}),c("eXrNq",function(e,o){t(e.exports),r(e.exports,"default",function(){return u});var a=l("djimy"),n=l("hWymx"),i=l("7dQGn"),s=l("cIjax"),c=l("jH98U"),u=/*#__PURE__*/(0,a.defineComponent)({__name:"BasicSlotGroup",props:{slotGroupConfig:{}},setup(e,{expose:t}){t();let{slotGroupConfig:r}=e,{getPrimary:o,getSecondary:l}=(0,i.useConfigStore)(),u=o(r.label),d=l(r.label),{slotGroups:p}=(0,s.useSlotGroupsStore)(),f=p.find(({id:e})=>e===r.id);(0,n.strict)(void 0!==f);let m=(0,a.ref)(0);(0,a.watchEffect)(()=>f.parameterTransforms.forEach((e,t)=>e.setActive(m.value>t)));let h={props:e,slotGroupConfig:r,getPrimary:o,getSecondary:l,primaryLabel:u,secondaryLabel:d,slotGroups:p,slotGroup:f,numActive:m,MarkerSlot:c.default};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}})}),c("jH98U",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("zgn46")).__esModule&&(o=o.default),o.render=l("gbmju").render,o.__cssModules={},l("65t20").default(o),o.__scopeId="data-v-4c322b",o.__file="MarkerSlot.vue";var a=o}),c("zgn46",function(e,o){t(e.exports),r(e.exports,"default",function(){return m});var a=l("djimy"),n=l("iNn5Y"),i=l("9OMm5"),s=l("7Rjir"),c=l("7dQGn"),u=l("f4LB1"),d=l("02fmQ"),p=l("fPRSg"),f=l("9QUOw"),m=/*#__PURE__*/(0,a.defineComponent)({__name:"MarkerSlot",props:{slotGroupId:{},primaryLabel:{},secondaryLabel:{},activeUrl:{},inactiveUrl:{},slotConfig:{}},emits:["activate","deactivate"],setup(e,{expose:t,emit:r}){t();let{slotConfig:o}=e,l=(0,a.ref)(e.slotGroupId),m=`${l.value}-${o.id}`,{toAssetUrl:h,extractAssetPosition:g}=(0,c.useConfigStore)(),y=h(e.activeUrl),b=h(e.inactiveUrl),S=g(y),_=g(b),k=(0,u.useAppStore)(),x=(0,d.useMarkerStore)(),{markerPositions:C}=x,P=(0,p.useSlotStore)(),T=new f.Circle(o.x,o.y,s.SLOT_CIRCLE_DIAMETER/2),E=[],I=(0,i.useArrayFilter)(C,e=>T.containsPoint(e));(0,a.watchEffect)(()=>{let e=(0,n.difference)(I.value,E),t=(0,n.difference)(E,I.value);t.forEach(({id:e})=>P.addActivation({slotId:m,markerId:e})),e.forEach(({id:e})=>P.addActivation({slotId:m,markerId:e})),E=I.value});let M=(0,a.computed)(()=>I.value.length>0);(0,a.watch)(()=>M.value,(e,t)=>{e&&!t?r("activate",{slotId:m,slotGroupId:l.value}):r("deactivate",{slotId:m,slotGroupId:l.value})});let R={props:e,slotConfig:o,slotGroupId:l,slotId:m,toAssetUrl:h,extractAssetPosition:g,markerSlotActiveUrl:y,markerSlotInactiveUrl:b,markerSlotActivePosition:S,markerSlotInactivePosition:_,appStore:k,markerStore:x,markerPositions:C,slotStore:P,slotCircle:T,get previousContainedMarkers(){return E},set previousContainedMarkers(v){E=v},containedMarkers:I,isActive:M,emit:r,get SLOT_CIRCLE_DIAMETER(){return s.SLOT_CIRCLE_DIAMETER}};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}})}),c("fPRSg",function(e,t){r(e.exports,"useSlotStore",function(){return n});var o=l("kV0Ly"),a=l("djimy");let n=(0,o.defineStore)("slot",()=>{let e=(0,a.ref)([]),t=t=>{let r=e.value.findIndex(({slotId:e,markerId:r})=>e===t.slotId&&r===t.markerId);-1!==r&&e.value.splice(r,1)};return{slotActivations:(0,a.readonly)(e),addActivation:r=>{t(r),e.value.push(r)},removeActivation:t}})}),c("9QUOw",function(e,t){r(e.exports,"Circle",function(){return o});class o{constructor(e,t,r){this.x=e,this.y=t,this.radius=r}clone(){return new o(this.x,this.y,this.radius)}containsPoint({x:e,y:t}){return(this.x-e)**2+(this.y-t)**2<=this.radius**2}containsCircle(e,t=0){let r=Math.sqrt((this.x-e.x)**2+(this.y-e.y)**2);return r+e.radius<=this.radius+t}static toCircumcircle(e){let t=e.x+e.width/2,r=e.y+e.height/2,a=Math.sqrt(e.width**2+e.height**2)/2;return new o(t,r,a)}static toIncircle(e){let t=e.x+e.width/2,r=e.y+e.height/2,a=Math.min(e.width,e.height)/2;return new o(t,r,a)}}}),c("gbmju",function(e,t){r(e.exports,"render",function(){return h});var o,a=l("djimy");let n=["data-slot-id"],i={class:"asset-container"},s=["src","alt"],c=["src","alt"],u={key:1,class:"label"},d={class:"primary-text"},p={class:"secondary-text"},f={key:2,class:"dev-label"},m=(o=()=>/*#__PURE__*/(0,a.createElementVNode)("br",null,null,-1),(0,a.pushScopeId)("data-v-4c322b"),o=o(),(0,a.popScopeId)(),o);function h(e,t,r,o,l,h){return(0,a.openBlock)(),(0,a.createElementBlock)("div",{"data-slot-id":o.slotConfig.id,class:"slot",style:(0,a.normalizeStyle)({"--slot-x":o.slotConfig.x,"--slot-y":o.slotConfig.y,"--slot-angle":`${o.slotConfig.angle}deg`,"--slot-diameter":o.SLOT_CIRCLE_DIAMETER})},[(0,a.createElementVNode)("div",i,[(0,a.withDirectives)((0,a.createElementVNode)("img",{src:o.markerSlotActiveUrl.href,alt:`${o.slotConfig.id}-active`,style:(0,a.normalizeStyle)({"--asset-x":o.markerSlotActivePosition.x,"--asset-y":o.markerSlotActivePosition.y})},null,12,s),[[a.vShow,o.isActive]]),(0,a.withDirectives)((0,a.createElementVNode)("img",{src:o.markerSlotInactiveUrl.href,alt:`${o.slotConfig.id}-inactive`,style:(0,a.normalizeStyle)({"--asset-x":o.markerSlotInactivePosition.x,"--asset-y":o.markerSlotInactivePosition.y})},null,12,c),[[a.vShow,!o.isActive]])]),o.appStore.isDeveloperModeActive?((0,a.openBlock)(),(0,a.createElementBlock)("div",{key:0,class:(0,a.normalizeClass)(["circle",{active:o.isActive,inactive:!o.isActive}])},null,2)):(0,a.createCommentVNode)("",!0),o.appStore.showMarkerSlotLabels?((0,a.openBlock)(),(0,a.createElementBlock)("div",u,[(0,a.createElementVNode)("div",d,(0,a.toDisplayString)(o.props.primaryLabel),1),(0,a.createElementVNode)("div",p,(0,a.toDisplayString)(o.props.secondaryLabel),1)])):(0,a.createCommentVNode)("",!0),o.appStore.isDeveloperModeActive?((0,a.openBlock)(),(0,a.createElementBlock)("div",f,[(0,a.createTextVNode)((0,a.toDisplayString)(o.slotGroupId),1),m,(0,a.createTextVNode)((0,a.toDisplayString)(o.slotConfig.id),1)])):(0,a.createCommentVNode)("",!0)],12,n)}}),c("65t20",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("jtxJg",function(e,t){r(e.exports,"render",function(){return n});var o=l("djimy");let a=["data-slot-group-id"];function n(e,t,r,n,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{"data-slot-group-id":n.slotGroupConfig.id},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.slotGroupConfig.markerSlots,e=>((0,o.openBlock)(),(0,o.createBlock)(n.MarkerSlot,{key:e.id,"slot-group-id":n.slotGroupConfig.id,"primary-label":n.primaryLabel,"secondary-label":n.secondaryLabel,"active-url":n.slotGroupConfig.assets.markerSlotActive.url,"inactive-url":n.slotGroupConfig.assets.markerSlotInactive.url,"slot-config":e,onActivate:t[0]||(t[0]=e=>n.numActive+=1),onDeactivate:t[1]||(t[1]=e=>n.numActive-=1)},null,8,["slot-group-id","primary-label","secondary-label","active-url","inactive-url","slot-config"]))),128))],8,a)}}),c("eESbR",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("1VbKL",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("hD1de")).__esModule&&(o=o.default),o.render=l("cqowQ").render,l("eT2xs").default(o),o.__scopeId="data-v-18dba8",o.__file="ActionCardSlotGroup.vue";var a=o}),c("hD1de",function(e,o){t(e.exports),r(e.exports,"default",function(){return d});var a=l("djimy"),n=l("hWymx"),i=l("7dQGn"),s=l("cIjax"),c=l("jH98U"),u=l("7RdUk"),d=/*#__PURE__*/(0,a.defineComponent)({__name:"ActionCardSlotGroup",props:{slotGroupConfig:{}},setup(e,{expose:t}){t();let{slotGroupConfig:r}=e,o=(0,i.useConfigStore)(),{actionCardDelayMs:l}=o.config.interaction,{getPrimary:d,getSecondary:p}=o,f=d(r.label),m=p(r.label),{slotGroups:h}=(0,s.useSlotGroupsStore)(),g=h.find(({id:e})=>e===r.id);(0,n.strict)(void 0!==g);let y=r.slots.map(e=>({slotConfig:e,assignment:(0,a.ref)(null),active:(0,a.ref)(!1),timeout:null})),b=r.cards.map(e=>{let t=g.parameterTransforms.find(t=>t.id===e.parameterTransformId);return(0,n.strict)(void 0!==t),{cardConfig:e,state:t}});y.forEach(e=>{(0,a.watch)(e.active,t=>{/* eslint-disable no-param-reassign */let{assignment:r}=e;if(t){if(null!==r.value){let{state:t}=r.value;console.log(t),console.log(`Activating ${t.id} at action card slot ${e.slotConfig.cardSlot.id}`),t.setActive(!0)}}else{if(null!==r.value){let t=r.value,{state:o}=t;console.log(`Deactivating ${o.id} at action card slot ${e.slotConfig.cardSlot.id}`),t.state.setActive(!1),console.log(`Removing ${t.state.id} from action card slot ${e.slotConfig.cardSlot.id}`),e.assignment.value=null,b.push(t)}null===e.timeout&&(e.timeout=setTimeout(()=>{e.timeout=null;let t=b.shift();(0,n.strict)(void 0!==t),console.log(`Assigning ${t.state.id} to action card slot ${e.slotConfig.cardSlot.id}`),r.value=t,r.value.state.setActive(e.active.value)},l))}},{immediate:!0})});let S={props:e,slotGroupConfig:r,configStore:o,actionCardDelayMs:l,getPrimary:d,getSecondary:p,primaryLabel:f,secondaryLabel:m,slotGroups:h,slotGroup:g,slotsWithCard:y,availableCardAssignments:b,MarkerSlot:c.default,CardSlot:u.default};return Object.defineProperty(S,"__isScriptSetup",{enumerable:!1,value:!0}),S}})}),c("7RdUk",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("afxwH")).__esModule&&(o=o.default),o.render=l("l66cW").render,o.__cssModules={},l("4GRYL").default(o),o.__scopeId="data-v-d849c7",o.__file="CardSlot.vue";var a=o}),c("afxwH",function(e,o){t(e.exports),r(e.exports,"default",function(){return s});var a=l("djimy"),n=l("f4LB1"),i=l("7lUOB"),s=/*#__PURE__*/(0,a.defineComponent)({__name:"CardSlot",props:{cardSlotConfig:{},cardConfig:{},active:{type:Boolean}},setup(e,{expose:t}){t();let r=(0,n.useAppStore)(),o={props:e,appStore:r,GameCard:i.default};return Object.defineProperty(o,"__isScriptSetup",{enumerable:!1,value:!0}),o}})}),c("7lUOB",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("7xQxQ")).__esModule&&(o=o.default),o.render=l("05aqY").render,o.__cssModules={},l("a3cWG").default(o),o.__scopeId="data-v-eed7e9",o.__file="GameCard.vue";var a=o}),c("7xQxQ",function(e,o){t(e.exports),r(e.exports,"default",function(){return s});var a=l("djimy"),n=l("7dQGn"),i=l("f4LB1"),s=/*#__PURE__*/(0,a.defineComponent)({__name:"GameCard",props:{url:{},label:{},active:{type:Boolean}},setup(e,{expose:t}){t();let{toAssetUrl:r}=(0,n.useConfigStore)(),o=(0,i.useAppStore)(),s=(0,a.computed)(()=>r(e.url)),l={props:e,toAssetUrl:r,appStore:o,assetUrl:s,position:{x:0,y:0}};return Object.defineProperty(l,"__isScriptSetup",{enumerable:!1,value:!0}),l}})}),c("05aqY",function(e,t){r(e.exports,"render",function(){return s});var o=l("djimy");let a=["src","alt"],n={key:0,class:"label"},i={class:"highlight"};function s(e,t,r,s,l,c){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:(0,o.normalizeClass)(["action-card",{active:s.props.active}]),style:(0,o.normalizeStyle)({"--card-x":s.position.x,"--card-y":s.position.y})},[(0,o.createElementVNode)("img",{src:s.assetUrl.href,alt:r.label,class:"image"},null,8,a),s.appStore.isDeveloperModeActive?((0,o.openBlock)(),(0,o.createElementBlock)("div",n,[(0,o.createElementVNode)("span",i,(0,o.toDisplayString)(r.label),1)])):(0,o.createCommentVNode)("",!0)],6)}}),c("a3cWG",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("l66cW",function(e,t){r(e.exports,"render",function(){return n});var o=l("djimy");let a={key:0,class:"label"};function n(e,t,r,n,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{style:(0,o.normalizeStyle)({"--card-x":r.cardSlotConfig.x,"--card-y":r.cardSlotConfig.y,"--card-angle":r.cardSlotConfig.angle}),class:(0,o.normalizeClass)(["card-slot",{"dev-mode":n.appStore.isDeveloperModeActive}])},[n.appStore.isDeveloperModeActive?((0,o.openBlock)(),(0,o.createElementBlock)("div",a,(0,o.toDisplayString)(r.cardSlotConfig.id),1)):(0,o.createCommentVNode)("",!0),null!==r.cardConfig?((0,o.openBlock)(),(0,o.createBlock)(n.GameCard,{key:1,url:r.cardConfig.url,label:r.cardConfig.parameterTransformId,active:n.props.active},null,8,["url","label","active"])):(0,o.createCommentVNode)("",!0)],6)}}),c("4GRYL",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("cqowQ",function(e,t){r(e.exports,"render",function(){return n});var o=l("djimy");let a=["data-slot-group-id"];function n(e,t,r,n,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{"data-slot-group-id":n.slotGroupConfig.id},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.slotsWithCard,e=>((0,o.openBlock)(),(0,o.createBlock)(n.CardSlot,{key:e.slotConfig.cardSlot.id,"card-slot-config":e.slotConfig.cardSlot,"card-config":e.assignment.value?.cardConfig??null,active:e.assignment.value?.state?.active??!1},null,8,["card-slot-config","card-config","active"]))),128)),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.slotsWithCard,e=>((0,o.openBlock)(),(0,o.createBlock)(n.MarkerSlot,{key:e.slotConfig.markerSlot.id,"slot-group-id":n.slotGroupConfig.id,"primary-label":n.primaryLabel,"secondary-label":n.secondaryLabel,"active-url":n.slotGroupConfig.assets.markerSlotActive.url,"inactive-url":n.slotGroupConfig.assets.markerSlotInactive.url,"slot-config":e.slotConfig.markerSlot,onActivate:t=>e.active.value=!0,onDeactivate:t=>e.active.value=!1},null,8,["slot-group-id","primary-label","secondary-label","active-url","inactive-url","slot-config","onActivate","onDeactivate"]))),128))],8,a)}}),c("eT2xs",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("jrojO",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("caiBL")).__esModule&&(o=o.default),o.render=l("jZwyy").render,l("hZr9M").default(o),o.__scopeId="data-v-0678b6",o.__file="EventCardSlotGroup.vue";var a=o}),c("caiBL",function(e,o){t(e.exports),r(e.exports,"default",function(){return d});var a=l("djimy"),n=l("hWymx"),i=l("cIjax"),s=l("jH98U"),c=l("llWLg"),u=l("7dQGn"),d=/*#__PURE__*/(0,a.defineComponent)({__name:"EventCardSlotGroup",props:{slotGroupConfig:{}},setup(e,{expose:t}){t();let{slotGroupConfig:r}=e,{markerSlot:o}=r,{slotGroups:l}=(0,i.useSlotGroupsStore)(),d=l.find(({id:e})=>e===r.id);(0,n.strict)(void 0!==d);let p=(0,a.ref)(!1),{getPrimary:f,getSecondary:m}=(0,u.useConfigStore)(),h=f(r.label),g=m(r.label),y={props:e,slotGroupConfig:r,markerSlotConfig:o,slotGroups:l,slotGroup:d,isMarkerSlotActive:p,getPrimary:f,getSecondary:m,primaryLabel:h,secondaryLabel:g,MarkerSlot:s.default,EventCardCycler:c.default};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}})}),c("llWLg",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("dIE4t")).__esModule&&(o=o.default),o.render=l("9hTqD").render,l("9NrRY").default(o),o.__scopeId="data-v-8092c9",o.__file="EventCardCycler.vue";var a=o}),c("dIE4t",function(e,o){t(e.exports),r(e.exports,"default",function(){return d});var a=l("djimy"),n=l("hWymx"),i=l("9OMm5"),s=l("7dQGn"),c=l("cIjax"),u=l("7RdUk"),d=/*#__PURE__*/(0,a.defineComponent)({__name:"EventCardCycler",props:{slotGroupConfig:{},enabled:{type:Boolean}},setup(e,{expose:t}){t();let{config:{interaction:{eventCardMinDelayMs:r,eventCardMaxDelayMs:o,eventCardMinDurationMs:l,eventCardMaxDurationMs:d}}}=(0,s.useConfigStore)(),{slotGroups:p}=(0,c.useSlotGroupsStore)(),f=p.find(({id:t})=>t===e.slotGroupConfig.id);(0,n.strict)(void 0!==f);let m=(e=1)=>e*r+Math.random()*Math.abs(o-r),h=()=>l+Math.random()*Math.abs(d-l),g=(0,a.reactive)(e.slotGroupConfig.cardSlots.map(e=>({cardSlotConfig:e,cardConfig:null,deactivateCard:()=>{},stopFilling:()=>{}})));(0,n.strict)(g.length>0),(0,n.strict)(e.slotGroupConfig.cards.length>0),(0,n.strict)(g.length<=e.slotGroupConfig.cards.length);let y=e.slotGroupConfig.cards.map(e=>{let t=f.parameterTransforms.find(t=>t.id===e.parameterTransformId);return(0,n.strict)(void 0!==t),{cardConfig:e,parameterTransform:t}}),b=()=>{let e=y.shift();return(0,n.strict)(void 0!==e),y.push(e),e},S=e=>{/* eslint-disable no-param-reassign */e.deactivateCard(),e.stopFilling();let{cardConfig:t,parameterTransform:r}=b();// eslint-disable-next-line no-param-reassign
e.cardConfig=t,r.active=!0;let o=h(),a=m();e.stopFilling(),e.stopFilling=(0,i.useTimeoutFn)(()=>S(e),o+a).stop;let n=(0,i.useTimeoutFn)(()=>e.deactivateCard(),o).stop;e.deactivateCard=()=>{n(),e.cardConfig=null,r.active=!1,e.deactivateCard=()=>{}}},_=()=>{/* eslint-disable no-param-reassign */let e=0;g.forEach(t=>{if(null===t.cardConfig){let r=0===e?0:m(e);t.stopFilling(),t.stopFilling=(0,i.useTimeoutFn)(()=>S(t),r).stop,e+=1}})},k=()=>{g.forEach(e=>{e.deactivateCard(),e.stopFilling()})};(0,a.watch)(()=>e.enabled,(e,t)=>{e!==t&&(e?_():k())},{immediate:!0});let x={props:e,eventCardMinDelayMs:r,eventCardMaxDelayMs:o,eventCardMinDurationMs:l,eventCardMaxDurationMs:d,slotGroups:p,slotGroup:f,getRandomDelayMs:m,getRandomDurationMs:h,cardSlotAssignments:g,eventCardPriorityQueue:y,getNextEventCard:b,fillCardSlot:S,activateCardSlotAssignments:_,deactivateCardSlotAssignments:k,CardSlot:u.default};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}})}),c("9hTqD",function(e,t){r(e.exports,"render",function(){return a});var o=l("djimy");function a(e,t,r,a,n,i){return(0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.cardSlotAssignments,e=>((0,o.openBlock)(),(0,o.createBlock)(a.CardSlot,{key:e.cardSlotConfig.id,"card-slot-config":e.cardSlotConfig,"card-config":e.cardConfig,active:!0},null,8,["card-slot-config","card-config"]))),128)}}),c("9NrRY",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("jZwyy",function(e,t){r(e.exports,"render",function(){return n});var o=l("djimy");let a=["data-slot-group-id"];function n(e,t,r,n,i,s){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{"data-slot-group-id":n.slotGroupConfig.id},[(0,o.createVNode)(n.EventCardCycler,{"slot-group-config":n.slotGroupConfig,enabled:n.isMarkerSlotActive},null,8,["slot-group-config","enabled"]),(0,o.createVNode)(n.MarkerSlot,{"slot-group-id":n.slotGroupConfig.id,"primary-label":n.primaryLabel,"secondary-label":n.secondaryLabel,"slot-config":n.markerSlotConfig,"active-url":n.slotGroupConfig.assets.markerSlotActive.url,"inactive-url":n.slotGroupConfig.assets.markerSlotInactive.url,onActivate:t[0]||(t[0]=e=>n.isMarkerSlotActive=!0),onDeactivate:t[1]||(t[1]=e=>n.isMarkerSlotActive=!1)},null,8,["slot-group-id","primary-label","secondary-label","slot-config","active-url","inactive-url"])],8,a)}}),c("hZr9M",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("kIEuR",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("Q9FY0")).__esModule&&(o=o.default),o.render=l("jhXpM").render,o.__cssModules={},l("8Gk17").default(o),o.__scopeId="data-v-3853c2",o.__file="ModelVisualization.vue";var a=o}),c("Q9FY0",function(e,a){t(e.exports),r(e.exports,"default",function(){return x});var n=l("djimy"),i=l("hWymx"),s=l("lOERq"),c=l("gkhY4"),u=l("7vmPr"),d=l("9OMm5"),p=l("gK2p2"),f=l("kV0Ly"),m=l("7Rjir"),h=l("f4LB1"),g=l("i5N9G"),y=l("5f8hv"),b=l("aDsGb"),S=l("aXhH2"),_=l("jcDd5"),k=l("etm9Z"),x=/*#__PURE__*/(0,n.defineComponent)({__name:"ModelVisualization",setup(e,{expose:t}){let r=new URL(l("9I5ug")),a=(0,p.default)(),x=["abandon","acquireNewlyProduced","acquireRefurbished","acquireRepaired","acquireUsed","disposeBroken","disposeHibernating","goBroken","landfill","produceFromNaturalResources","produceFromRecycledMaterials","recycle","refurbish","repair"],C=["recycledMaterials","repairedPhones","refurbishedPhones","newlyProducedPhones","phonesInUse"],P=["recycledMaterials","hibernatingPhones","disposedPhones","brokenPhones","repairedPhones","refurbishedPhones","newlyProducedPhones"],T=["phonesInUse"],E={capacity:C,supply:P,verbatim:T},I={abandon:1,acquireNewlyProduced:-1,acquireRefurbished:-1,acquireRepaired:-1,acquireUsed:-1,disposeBroken:-1,disposeHibernating:-1,goBroken:-1,landfill:-1,produceFromNaturalResources:-1,produceFromRecycledMaterials:-1,recycle:-1,refurbish:-1,repair:-1},M=(0,S.loadSvg)(r),R=(0,h.useAppStore)(),O=(0,g.useModelStore)(),A=(0,y.useVisualizationStore)(),{scaleFactors:w}=(0,f.storeToRefs)(A),N=(0,n.ref)({deltaMs:0,stepSize:0,flowVizScale:1,stockVizScale:1,record:O.record}),B=e=>{let t=(0,n.computed)(()=>{let{record:t}=N.value,{stocks:r}=t,o=r[e],{stockVizScale:a}=N.value;return Math.sqrt(o*a/Math.PI)});return{radius:t}},D=e=>{let t=0,r=(0,n.computed)(()=>{let{deltaMs:r,flowVizScale:o,record:a}=N.value,{flows:n}=a,i=n[e],s=I[e],l=(Number.isNaN(t)?0:t)+s*Math.min(r*o*i,10);return t=l,l});return{dashoffset:r}},j=e=>{let t=N.value.record.flows[e],r=(0,n.computed)(()=>{// TODO: fine-tune formula
let{flowVizScale:r,record:a,stepSize:n}=N.value,i=a.flows[e],s=(i-t)/n,l=w.value.flowHighlight*r*s,c=/*@__PURE__*/o(u)((1+Math.sign(l)*Math.sqrt(Math.abs(l)))/2,0,1);return t=i,R.highlightDerivatives&&!Number.isNaN(c)?c:.5});return{highlight:r}},L=e=>x.map(t=>{let r=(0,k.guardedQuerySelector)(SVGGeometryElement,`#${/*@__PURE__*/o(s)(t)}`,e),a=r.getAttribute("d");(0,i.strict)(null!==a,`SVG path for flow ${t} not found.`);let n=(0,d.toReactive)({id:t,svgPath:a,dashOffset:D(t).dashoffset,highlight:j(t).highlight});return n}),V=(e,t)=>{let r=E[t];return r.map(r=>{let a=(0,k.guardedQuerySelector)(SVGGeometryElement,`#${/*@__PURE__*/o(s)(r)}`,e);(0,i.strict)("circle"===a.tagName);let{x:n,y:l}=(0,_.getCircleCenter)(a),u="verbatim"===t?r:/*@__PURE__*/o(c)(`${t}-of-${/*@__PURE__*/o(s)(r)}`);(0,i.strict)((0,b.stockIds).includes(u),`${u} is no valid stockId (${(0,b.stockIds).join(", ")})`);let p=(0,d.toReactive)({id:u,x:n,y:l,radius:B(u).radius,highlight:0});return p})},F=(0,n.ref)([]),G=(0,n.ref)([]),U=(0,n.ref)([]),q=(0,n.ref)([]),H=(0,n.ref)([]);(0,n.onMounted)(()=>{M.then(e=>{U.value.push(...L(e)),F.value.push(...V(e,"capacity")),G.value.push(...V(e,"supply"),...V(e,"verbatim"))})});let z=(e,t,r)=>{let o=w.value.flow/r.parameters.numberOfUsers,a=w.value.stock/r.parameters.numberOfUsers;N.value={deltaMs:e,stepSize:t,flowVizScale:o,stockVizScale:a,record:r}};t({update:z});let $={svgUrl:r,uuid:a,mainFlowIds:x,mainCapacityIds:C,mainSupplyIds:P,additionalVerbatimSupplyIds:T,stockIdsMap:E,flowVizSigns:I,svgPromise:M,appStore:R,modelStore:O,visualizationStore:A,scaleFactors:w,updateInfo:N,useStockToRadius:B,useFlowToDashoffset:D,useFlowToHighlight:j,extractFlowDescriptions:L,extractStockDescriptions:V,capacityDescriptions:F,supplyDescriptions:G,flowDescriptions:U,flowElements:q,supplyElements:H,update:z,get BOARD_WIDTH(){return m.BOARD_WIDTH},get BOARD_HEIGHT(){return m.BOARD_HEIGHT}};return Object.defineProperty($,"__isScriptSetup",{enumerable:!1,value:!0}),$}})}),c("aXhH2",function(e,t){r(e.exports,"loadSvg",function(){return o});/**
 * Loads an external SVG file and returns the DOM tree of its first <svg> element.
 *
 * @param {string|URL} uri
 * @param {boolean} clearStyles
 *  If true removes the style elements from the file
 * @return {Promise<SVGSVGElement>}
 */async function o(e,t=!0){let r=await fetch(e);if(r.status<200||r.status>=300)throw Error(`Server returned status ${r.status} (${r.statusText}) loading ${new URL(e).href}.`);let o=await r.text(),a=document.createElement("div");a.innerHTML=o;let n=a.querySelector("svg");if(null===n)throw Error(`No SVG element found in ${new URL(e).href}.`);return t&&n.querySelectorAll("style")?.forEach(e=>e.remove()),n}}),c("jcDd5",function(e,t){r(e.exports,"getCircleCenter",function(){return a});var o=l("hWymx");function a(e){let t=parseFloat(e.getAttribute("cx")??"");(0,o.strict)(!Number.isNaN(t));let r=parseFloat(e.getAttribute("cy")??"");return(0,o.strict)(!Number.isNaN(r)),{x:t,y:r}}}),c("etm9Z",function(e,t){r(e.exports,"guardedQuerySelector",function(){return o});function o(e,t,r=document){let o=r.querySelector(t);if(null===o)throw Error(`No element found matching selector ${t}.`);if(!(o instanceof e))throw Error(`Element matching selector ${t} has the wrong type.`);return o}}),c("9I5ug",function(e,t){e.exports=l("5CpQN").getBundleURL("6xGL6")+"model.08756a01.svg"}),c("jhXpM",function(e,t){r(e.exports,"render",function(){return d});var o=l("djimy");let a=["width","height","viewBox"],n=["id","data-label","d","stroke-dashoffset"],i=["cx","cy","r"],s=["id","data-label","cx","cy","r"],c=["xlink:href"],u=["x","y"];function d(e,t,r,l,d,p){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{ref:"container",class:"model-viz-container",style:(0,o.normalizeStyle)({"--dev-mode-label-display":l.appStore.isDeveloperModeActive?"inline":"none"})},[((0,o.openBlock)(),(0,o.createElementBlock)("svg",{width:l.BOARD_WIDTH,height:l.BOARD_HEIGHT,viewBox:`0 0 ${l.BOARD_WIDTH} ${l.BOARD_HEIGHT}`,"xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg",class:"model-visualization"},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(l.flowDescriptions,e=>((0,o.openBlock)(),(0,o.createElementBlock)("path",{key:e.id,id:`${e.id}-${l.uuid}`,ref_for:!0,ref:"flowElements","data-label":e.id,d:e.svgPath,"stroke-dashoffset":e.dashOffset,class:"flow anim-edge",style:(0,o.normalizeStyle)({"--highlight":e.highlight})},null,12,n))),128)),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(l.capacityDescriptions,e=>((0,o.openBlock)(),(0,o.createElementBlock)("circle",{key:e.id,cx:e.x,cy:e.y,r:e.radius,class:"stock capacity"},null,8,i))),128)),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(l.supplyDescriptions,e=>((0,o.openBlock)(),(0,o.createElementBlock)("circle",{key:e.id,id:`${e.id}-${l.uuid}`,ref_for:!0,ref:"supplyElements","data-label":e.id,cx:e.x,cy:e.y,r:e.radius,class:"stock supply"},null,8,s))),128)),l.appStore.isDeveloperModeActive?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(l.flowElements,e=>((0,o.openBlock)(),(0,o.createElementBlock)("text",{key:e.id},[(0,o.createElementVNode)("textPath",{"xlink:href":`#${e.id}`,startOffset:"50%","text-anchor":"middle","dominant-baseline":"middle",class:"label"},(0,o.toDisplayString)(e.dataset.label),9,c)]))),128)),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(l.supplyElements,e=>((0,o.openBlock)(),(0,o.createElementBlock)("text",{key:e.id,x:e.getAttribute("cx"),y:e.getAttribute("cy"),class:"label"},(0,o.toDisplayString)(e.dataset.label),9,u))),128))],64)):(0,o.createCommentVNode)("",!0)],8,a))],4)}}),c("8Gk17",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("5RKs2",function(e,t){let o;r(e.exports,"default",function(){return a}),(o=l("8wLpO")).__esModule&&(o=o.default),o.render=l("dFh5r").render,o.__cssModules={},l("lO3hs").default(o),o.__scopeId="data-v-e2cbc0",o.__file="ResetTimeoutOverlay.vue";var a=o}),c("8wLpO",function(e,o){t(e.exports),r(e.exports,"default",function(){return u});var a=l("djimy"),n=l("9OMm5"),i=l("7dQGn"),s=l("i5N9G"),c=l("8CFAD"),u=/*#__PURE__*/(0,a.defineComponent)({__name:"ResetTimeoutOverlay",setup(e,{expose:t}){t();let{config:r,getPrimary:o,getSecondary:l}=(0,i.useConfigStore)(),{autoReset:u}=r.general,d=(0,s.useModelStore)(),p=(0,a.ref)(-1),f=(0,c.compile)(u.condition),m=()=>{},h=()=>{};function g(){m=(0,a.watch)(d.record,e=>{f(e)&&(m(),p.value=Math.round(u.timeoutSeconds),h=(0,n.useIntervalFn)(()=>{switch(p.value-=1,p.value){case 0:d.reset();break;case -1:h(),g()}}).pause)})}(0,a.onMounted)(g),(0,a.onUnmounted)(()=>{m(),h(),p.value=-1});let y={config:r,getPrimary:o,getSecondary:l,autoResetConfig:u,modelStore:d,remainingSeconds:p,resetCondition:f,get unwatch(){return m},set unwatch(v){m=v},get stopCountdown(){return h},set stopCountdown(v){h=v},watchModel:g};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}})}),c("dFh5r",function(e,t){r(e.exports,"render",function(){return p});var o=l("djimy");let a={class:"title"},n={class:"primary-text"},i={class:"secondary-text"},s={class:"countdown"},c={class:"description"},u={class:"primary-text"},d={class:"secondary-text"};function p(e,t,r,l,p,f){return l.remainingSeconds>-1?((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:0,class:(0,o.normalizeClass)(["reset-timeout-panel",{"fade-in":l.remainingSeconds>0,"fade-out":l.remainingSeconds<=0}])},[(0,o.createElementVNode)("div",a,[(0,o.createElementVNode)("div",n,(0,o.toDisplayString)(l.getPrimary(l.autoResetConfig.title).value),1),(0,o.createElementVNode)("div",i,(0,o.toDisplayString)(l.getSecondary(l.autoResetConfig.title).value),1)]),(0,o.createElementVNode)("div",s,(0,o.toDisplayString)(Math.max(0,l.remainingSeconds)),1),(0,o.createElementVNode)("div",c,[(0,o.createElementVNode)("div",u,(0,o.toDisplayString)(l.getPrimary(l.autoResetConfig.description).value),1),(0,o.createElementVNode)("div",d,(0,o.toDisplayString)(l.getSecondary(l.autoResetConfig.description).value),1)])],2)):(0,o.createCommentVNode)("",!0)}}),c("lO3hs",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}}),c("8C4qt",function(e,t){r(e.exports,"ignorePromise",function(){return o});function o(e){}}),c("6h466",function(e,t){r(e.exports,"ModelSimulator",function(){return o});class o{constructor(e,t,r,o,a,n){this.model=e,this.parameters=r,this.flowPerStockCache=null,this.record=this.model.evaluate(t,r,o),this.deltaPerSecond=a,this.maxStepSize=n,this.flowEvaluator=this.model.createFlowEvaluator(r),this.flowEvaluatorWithCache=this.evaluateFlowPerStockWithCache.bind(this)}evaluateFlowPerStockWithCache(e,t){return null!==this.flowPerStockCache&&this.flowPerStockCache.t===t?[...this.flowPerStockCache.value]:this.flowEvaluator(e,t)}tick(e){let t=this.record.t+e*this.deltaPerSecond;for(;this.record.t<t;){let e=Math.min(this.maxStepSize,t-this.record.t);this.step(e)}return this.record}step(e){let{stocks:t,parameters:r,t:o}=this.record,a=this.model.step(t,o,e,this.flowEvaluatorWithCache),n=this.model.evaluate(a,r,o+e);return this.flowPerStockCache={t:n.t,value:this.model.stocksToStockArray(this.model.accumulateFlowsPerStock(n.flows))},this.record=n,n}}}),c("9cXwb",function(e,t){r(e.exports,"Runner",function(){return s});var o=l("3ZGF0"),a=l("hWymx"),n=l("8C4qt");function i(){let e=document.timeline?.currentTime;return null==e?performance.now():"number"==typeof e?e:e.to("ms").value}class s extends o.EventEmitter{play(){this.shouldRun=!0,(0,n.ignorePromise)(this.run())}pause(){this.shouldRun=!1,null!==this.cancelAnimationFrameCallback&&this.cancelAnimationFrameCallback()}isPlaying(){return this.running}isPaused(){return!this.running}shouldPlay(){return this.shouldRun}shouldPause(){return!this.shouldRun}togglePlayPause(){this.shouldRun?this.pause():this.play()}tick(){this.isPlaying()?((0,a.strict)(null!==this.cancelAnimationFrameCallback),this.cancelAnimationFrameCallback()):(this.play(),this.pause())}async run(){if(this.running||!this.shouldRun)return;this.running=!0,this.emit("play");// Keep track of the offset between this runner and the global animation time.
// The offset increases by the time the runner was paused.
let e=i();this.timeStampOffset+=e-this.lastTimeStamp,// The first tick will be emitted with a delta of 0, i.e. the attached listeners should not progress.
// If renderers are attached, they should just render the current state.
this.lastTimeStamp=e;do{let t=e-this.lastTimeStamp;// Account for the case where the runner has been paused during the tick event
if(this.emit("tick",t,e,this.lastTimeStamp,this.timeStampOffset),this.lastTimeStamp=e,!this.shouldRun)break;try{// Wait for the next animation frame
// eslint-disable-next-line no-await-in-loop
e=await new Promise((e,t)=>{let r=requestAnimationFrame(e);this.cancelAnimationFrameCallback=()=>{cancelAnimationFrame(r),this.cancelAnimationFrameCallback=null,this.shouldRun?e(i()):t()}})}catch(e){// The runner was paused while waiting for the next animation frame
}}while(this.shouldRun)this.running=!1,this.emit("pause")}constructor(...e){super(...e),this.shouldRun=!1,this.running=!1,this.timeStampOffset=0,this.lastTimeStamp=i(),this.cancelAnimationFrameCallback=null}}}),c("k5vMz",function(e,t){r(e.exports,"render",function(){return n});var o=l("djimy");let a={class:"marker-panel abs-top-left"};function n(e,t,r,n,i,s){return(0,o.openBlock)(),(0,o.createBlock)(n.ScaledLetterBox,{"target-size":{width:n.BOARD_WIDTH,height:n.BOARD_HEIGHT},class:"scaled-letterbox",onResize:t[1]||(t[1]=e=>n.appStore.scale=e)},{default:(0,o.withCtx)(()=>[(0,o.createElementVNode)("div",{class:"layer-panel abs-top-left",style:(0,o.normalizeStyle)({"--app-width":n.BOARD_WIDTH,"--app-height":n.BOARD_HEIGHT})},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.config.layers,(e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[e===n.BUILTIN_LAYER_NAMES.modelVisualization?((0,o.openBlock)(),(0,o.createBlock)(n.ModelVisualization,{ref_for:!0,ref:"modelVisualizations",class:"model-visualization",key:`layer-${t}-model-visualization`})):e===n.BUILTIN_LAYER_NAMES.scores?((0,o.openBlock)(),(0,o.createBlock)(n.ScoreLayer,{key:`layer-${t}-scores`})):e===n.BUILTIN_LAYER_NAMES.slots?((0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"slot-panel abs-top-left",key:`layer-${t}-slots`},[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(n.config.interaction.slotGroups,e=>((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:e.id},["basic"===e.type?((0,o.openBlock)(),(0,o.createBlock)(n.BasicSlotGroup,{key:0,"slot-group-config":e},null,8,["slot-group-config"])):(0,o.createCommentVNode)("",!0),"action-card"===e.type?((0,o.openBlock)(),(0,o.createBlock)(n.ActionCardSlotGroup,{key:1,"slot-group-config":e},null,8,["slot-group-config"])):(0,o.createCommentVNode)("",!0),"event-card"===e.type?((0,o.openBlock)(),(0,o.createBlock)(n.EventCardSlotGroup,{key:2,"slot-group-config":e},null,8,["slot-group-config"])):(0,o.createCommentVNode)("",!0)],64))),128))])):((0,o.openBlock)(),(0,o.createBlock)(n.ConditionalLayer,{"layer-config":e,key:`layer-${t}-conditional`},null,8,["layer-config"]))],64))),256))],4),(0,o.createElementVNode)("div",a,[n.options.usePointerMarkers?((0,o.openBlock)(),(0,o.createBlock)(n.PointerMarkerPanel,{key:0})):(0,o.createCommentVNode)("",!0),n.options.useTuioMarkers?((0,o.openBlock)(),(0,o.createBlock)(n.TuioMarkerPanel,{key:1,class:"pointer-events-fallthrough"})):(0,o.createCommentVNode)("",!0)]),n.appStore.autoReset?((0,o.openBlock)(),(0,o.createBlock)(n.ResetTimeoutOverlay,{key:0})):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(n.ControlPanel,{onKeydown:t[0]||(t[0]=e=>e.stopPropagation()),disabled:!n.enableControlPanel},null,8,["disabled"])]),_:1},8,["target-size"])}}),c("feskM",function(e,t){r(e.exports,"default",function(){return o});var o=e=>{}});var u=l("djimy"),d=l("kV0Ly");l("5jyqD").Tab,(e=l("fkeW0")).__esModule&&(e=e.default),e.render=l("k5vMz").render,e.__cssModules={},l("feskM").default(e),e.__scopeId="data-v-da1711",e.__file="App.vue";var p=e,f=l("coVQp");async function m(){return new Promise(e=>{let t=document.readyState;("complete"===t||"interactive"===t)&&setTimeout(e,0),document.addEventListener("DOMContentLoaded",()=>e())})}var h=l("7Rjir"),g=l("jbw4D"),y=l("32FrR"),b=l("5oapB"),S=l("dzT8j"),_=l("jqffs"),h=l("7Rjir"),k=l("flGFW");async function x(){let e=await (0,f.ConfigLoader).safeLoad(...h.CONFIG_URLS);if(!e.ok){let{config:t,error:r}=e.error;if(console.error("Invalid configuration:",t),r instanceof g.DuplicateIdError)console.error(r.message);else{let{errors:e,explanation:t}=r;console.error(t),console.error("Issues reported by the configuration validator:",...e??[])}throw Error("Error loading configuration. See console for details.")}return e.data}async function C(){let e=await x();console.log(e);let t=(0,d.createPinia)(),r=(0,u.createApp)(p);r.provide(h.CONFIG_INJECTION_KEY,e),r.use(t);let o=r.mount(document.body);return{app:o}}null!==k.sentryDsn&&(a=k.sentryDsn,y.init({dsn:a,transport:b.makeBrowserOfflineTransport(S.makeFetchTransport),transportOptions:{},release:h.GIT_VERSION_INFO.tag??h.GIT_VERSION_INFO.hash??"unknown",tracesSampleRate:0,replaysSessionSampleRate:0,replaysOnErrorSampleRate:0,integrations:[_.captureConsoleIntegration({// array of methods that should be captured
// defaults to ['log', 'info', 'warn', 'error', 'debug', 'assert']
levels:["error"]})]})),// This is for setting global Vue.js option that should actually be set by the bundler, but aren't.
/* eslint-disable */// @ts-ignore
globalThis.__VUE_OPTIONS_API__=!0,// @ts-ignore
globalThis.__VUE_PROD_DEVTOOLS__=!0,// @ts-ignore
globalThis.__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!0,window.circularEconomy=m().then(C)}();//# sourceMappingURL=index.fa4e1842.js.map

//# sourceMappingURL=index.fa4e1842.js.map
